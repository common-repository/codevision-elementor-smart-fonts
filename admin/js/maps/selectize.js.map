{"version":3,"file":"../selectize.js","sources":["selectize.js"],"sourcesContent":["/**\n * sifter.js\n * Copyright (c) 2013 Brian Reavis & contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n * @author Brian Reavis <brian@thirdroute.com>\n */\n\n(function(root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine('sifter', factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.Sifter = factory();\n\t}\n}(this, function() {\n\n\t/**\n\t * Textually searches arrays and hashes of objects\n\t * by property (or multiple properties). Designed\n\t * specifically for autocomplete.\n\t *\n\t * @constructor\n\t * @param {array|object} items\n\t * @param {object} items\n\t */\n\tvar Sifter = function(items, settings) {\n\t\tthis.items = items;\n\t\tthis.settings = settings || {diacritics: true};\n\t};\n\n\t/**\n\t * Splits a search string into an array of individual\n\t * regexps to be used to match results.\n\t *\n\t * @param {string} query\n\t * @returns {array}\n\t */\n\tSifter.prototype.tokenize = function(query) {\n\t\tquery = trim(String(query || '').toLowerCase());\n\t\tif (!query || !query.length) return [];\n\n\t\tvar i, n, regex, letter;\n\t\tvar tokens = [];\n\t\tvar words = query.split(/ +/);\n\n\t\tfor (i = 0, n = words.length; i < n; i++) {\n\t\t\tregex = escape_regex(words[i]);\n\t\t\tif (this.settings.diacritics) {\n\t\t\t\tfor (letter in DIACRITICS) {\n\t\t\t\t\tif (DIACRITICS.hasOwnProperty(letter)) {\n\t\t\t\t\t\tregex = regex.replace(new RegExp(letter, 'g'), DIACRITICS[letter]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\ttokens.push({\n\t\t\t\tstring : words[i],\n\t\t\t\tregex  : new RegExp(regex, 'i')\n\t\t\t});\n\t\t}\n\n\t\treturn tokens;\n\t};\n\n\t/**\n\t * Iterates over arrays and hashes.\n\t *\n\t * ```\n\t * this.iterator(this.items, function(item, id) {\n\t *    // invoked for each item\n\t * });\n\t * ```\n\t *\n\t * @param {array|object} object\n\t */\n\tSifter.prototype.iterator = function(object, callback) {\n\t\tvar iterator;\n\t\tif (is_array(object)) {\n\t\t\titerator = Array.prototype.forEach || function(callback) {\n\t\t\t\tfor (var i = 0, n = this.length; i < n; i++) {\n\t\t\t\t\tcallback(this[i], i, this);\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\titerator = function(callback) {\n\t\t\t\tfor (var key in this) {\n\t\t\t\t\tif (this.hasOwnProperty(key)) {\n\t\t\t\t\t\tcallback(this[key], key, this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\titerator.apply(object, [callback]);\n\t};\n\n\t/**\n\t * Returns a function to be used to score individual results.\n\t *\n\t * Good matches will have a higher score than poor matches.\n\t * If an item is not a match, 0 will be returned by the function.\n\t *\n\t * @param {object|string} search\n\t * @param {object} options (optional)\n\t * @returns {function}\n\t */\n\tSifter.prototype.getScoreFunction = function(search, options) {\n\t\tvar self, fields, tokens, token_count, nesting;\n\n\t\tself        = this;\n\t\tsearch      = self.prepareSearch(search, options);\n\t\ttokens      = search.tokens;\n\t\tfields      = search.options.fields;\n\t\ttoken_count = tokens.length;\n\t\tnesting     = search.options.nesting;\n\n\t\t/**\n\t\t * Calculates how close of a match the\n\t\t * given value is against a search token.\n\t\t *\n\t\t * @param {mixed} value\n\t\t * @param {object} token\n\t\t * @return {number}\n\t\t */\n\t\tvar scoreValue = function(value, token) {\n\t\t\tvar score, pos;\n\n\t\t\tif (!value) return 0;\n\t\t\tvalue = String(value || '');\n\t\t\tpos = value.search(token.regex);\n\t\t\tif (pos === -1) return 0;\n\t\t\tscore = token.string.length / value.length;\n\t\t\tif (pos === 0) score += 0.5;\n\t\t\treturn score;\n\t\t};\n\n\t\t/**\n\t\t * Calculates the score of an object\n\t\t * against the search query.\n\t\t *\n\t\t * @param {object} token\n\t\t * @param {object} data\n\t\t * @return {number}\n\t\t */\n\t\tvar scoreObject = (function() {\n\t\t\tvar field_count = fields.length;\n\t\t\tif (!field_count) {\n\t\t\t\treturn function() { return 0; };\n\t\t\t}\n\t\t\tif (field_count === 1) {\n\t\t\t\treturn function(token, data) {\n\t\t\t\t\treturn scoreValue(getattr(data, fields[0], nesting), token);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn function(token, data) {\n\t\t\t\tfor (var i = 0, sum = 0; i < field_count; i++) {\n\t\t\t\t\tsum += scoreValue(getattr(data, fields[i], nesting), token);\n\t\t\t\t}\n\t\t\t\treturn sum / field_count;\n\t\t\t};\n\t\t})();\n\n\t\tif (!token_count) {\n\t\t\treturn function() { return 0; };\n\t\t}\n\t\tif (token_count === 1) {\n\t\t\treturn function(data) {\n\t\t\t\treturn scoreObject(tokens[0], data);\n\t\t\t};\n\t\t}\n\n\t\tif (search.options.conjunction === 'and') {\n\t\t\treturn function(data) {\n\t\t\t\tvar score;\n\t\t\t\tfor (var i = 0, sum = 0; i < token_count; i++) {\n\t\t\t\t\tscore = scoreObject(tokens[i], data);\n\t\t\t\t\tif (score <= 0) return 0;\n\t\t\t\t\tsum += score;\n\t\t\t\t}\n\t\t\t\treturn sum / token_count;\n\t\t\t};\n\t\t} else {\n\t\t\treturn function(data) {\n\t\t\t\tfor (var i = 0, sum = 0; i < token_count; i++) {\n\t\t\t\t\tsum += scoreObject(tokens[i], data);\n\t\t\t\t}\n\t\t\t\treturn sum / token_count;\n\t\t\t};\n\t\t}\n\t};\n\n\t/**\n\t * Returns a function that can be used to compare two\n\t * results, for sorting purposes. If no sorting should\n\t * be performed, `null` will be returned.\n\t *\n\t * @param {string|object} search\n\t * @param {object} options\n\t * @return function(a,b)\n\t */\n\tSifter.prototype.getSortFunction = function(search, options) {\n\t\tvar i, n, self, field, fields, fields_count, multiplier, multipliers, get_field, implicit_score, sort;\n\n\t\tself   = this;\n\t\tsearch = self.prepareSearch(search, options);\n\t\tsort   = (!search.query && options.sort_empty) || options.sort;\n\n\t\t/**\n\t\t * Fetches the specified sort field value\n\t\t * from a search result item.\n\t\t *\n\t\t * @param  {string} name\n\t\t * @param  {object} result\n\t\t * @return {mixed}\n\t\t */\n\t\tget_field = function(name, result) {\n\t\t\tif (name === '$score') return result.score;\n\t\t\treturn getattr(self.items[result.id], name, options.nesting);\n\t\t};\n\n\t\t// parse options\n\t\tfields = [];\n\t\tif (sort) {\n\t\t\tfor (i = 0, n = sort.length; i < n; i++) {\n\t\t\t\tif (search.query || sort[i].field !== '$score') {\n\t\t\t\t\tfields.push(sort[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// the \"$score\" field is implied to be the primary\n\t\t// sort field, unless it's manually specified\n\t\tif (search.query) {\n\t\t\timplicit_score = true;\n\t\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\t\tif (fields[i].field === '$score') {\n\t\t\t\t\timplicit_score = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (implicit_score) {\n\t\t\t\tfields.unshift({field: '$score', direction: 'desc'});\n\t\t\t}\n\t\t} else {\n\t\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\t\tif (fields[i].field === '$score') {\n\t\t\t\t\tfields.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmultipliers = [];\n\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\tmultipliers.push(fields[i].direction === 'desc' ? -1 : 1);\n\t\t}\n\n\t\t// build function\n\t\tfields_count = fields.length;\n\t\tif (!fields_count) {\n\t\t\treturn null;\n\t\t} else if (fields_count === 1) {\n\t\t\tfield = fields[0].field;\n\t\t\tmultiplier = multipliers[0];\n\t\t\treturn function(a, b) {\n\t\t\t\treturn multiplier * cmp(\n\t\t\t\t\tget_field(field, a),\n\t\t\t\t\tget_field(field, b)\n\t\t\t\t);\n\t\t\t};\n\t\t} else {\n\t\t\treturn function(a, b) {\n\t\t\t\tvar i, result, a_value, b_value, field;\n\t\t\t\tfor (i = 0; i < fields_count; i++) {\n\t\t\t\t\tfield = fields[i].field;\n\t\t\t\t\tresult = multipliers[i] * cmp(\n\t\t\t\t\t\tget_field(field, a),\n\t\t\t\t\t\tget_field(field, b)\n\t\t\t\t\t);\n\t\t\t\t\tif (result) return result;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\t};\n\n\t/**\n\t * Parses a search query and returns an object\n\t * with tokens and fields ready to be populated\n\t * with results.\n\t *\n\t * @param {string} query\n\t * @param {object} options\n\t * @returns {object}\n\t */\n\tSifter.prototype.prepareSearch = function(query, options) {\n\t\tif (typeof query === 'object') return query;\n\n\t\toptions = extend({}, options);\n\n\t\tvar option_fields     = options.fields;\n\t\tvar option_sort       = options.sort;\n\t\tvar option_sort_empty = options.sort_empty;\n\n\t\tif (option_fields && !is_array(option_fields)) options.fields = [option_fields];\n\t\tif (option_sort && !is_array(option_sort)) options.sort = [option_sort];\n\t\tif (option_sort_empty && !is_array(option_sort_empty)) options.sort_empty = [option_sort_empty];\n\n\t\treturn {\n\t\t\toptions : options,\n\t\t\tquery   : String(query || '').toLowerCase(),\n\t\t\ttokens  : this.tokenize(query),\n\t\t\ttotal   : 0,\n\t\t\titems   : []\n\t\t};\n\t};\n\n\t/**\n\t * Searches through all items and returns a sorted array of matches.\n\t *\n\t * The `options` parameter can contain:\n\t *\n\t *   - fields {string|array}\n\t *   - sort {array}\n\t *   - score {function}\n\t *   - filter {bool}\n\t *   - limit {integer}\n\t *\n\t * Returns an object containing:\n\t *\n\t *   - options {object}\n\t *   - query {string}\n\t *   - tokens {array}\n\t *   - total {int}\n\t *   - items {array}\n\t *\n\t * @param {string} query\n\t * @param {object} options\n\t * @returns {object}\n\t */\n\tSifter.prototype.search = function(query, options) {\n\t\tvar self = this, value, score, search, calculateScore;\n\t\tvar fn_sort;\n\t\tvar fn_score;\n\n\t\tsearch  = this.prepareSearch(query, options);\n\t\toptions = search.options;\n\t\tquery   = search.query;\n\n\t\t// generate result scoring function\n\t\tfn_score = options.score || self.getScoreFunction(search);\n\n\t\t// perform search and sort\n\t\tif (query.length) {\n\t\t\tself.iterator(self.items, function(item, id) {\n\t\t\t\tscore = fn_score(item);\n\t\t\t\tif (options.filter === false || score > 0) {\n\t\t\t\t\tsearch.items.push({'score': score, 'id': id});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tself.iterator(self.items, function(item, id) {\n\t\t\t\tsearch.items.push({'score': 1, 'id': id});\n\t\t\t});\n\t\t}\n\n\t\tfn_sort = self.getSortFunction(search, options);\n\t\tif (fn_sort) search.items.sort(fn_sort);\n\n\t\t// apply limits\n\t\tsearch.total = search.items.length;\n\t\tif (typeof options.limit === 'number') {\n\t\t\tsearch.items = search.items.slice(0, options.limit);\n\t\t}\n\n\t\treturn search;\n\t};\n\n\t// utilities\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\tvar cmp = function(a, b) {\n\t\tif (typeof a === 'number' && typeof b === 'number') {\n\t\t\treturn a > b ? 1 : (a < b ? -1 : 0);\n\t\t}\n\t\ta = asciifold(String(a || ''));\n\t\tb = asciifold(String(b || ''));\n\t\tif (a > b) return 1;\n\t\tif (b > a) return -1;\n\t\treturn 0;\n\t};\n\n\tvar extend = function(a, b) {\n\t\tvar i, n, k, object;\n\t\tfor (i = 1, n = arguments.length; i < n; i++) {\n\t\t\tobject = arguments[i];\n\t\t\tif (!object) continue;\n\t\t\tfor (k in object) {\n\t\t\t\tif (object.hasOwnProperty(k)) {\n\t\t\t\t\ta[k] = object[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn a;\n\t};\n\n\t/**\n\t * A property getter resolving dot-notation\n\t * @param  {Object}  obj     The root object to fetch property on\n\t * @param  {String}  name    The optionally dotted property name to fetch\n\t * @param  {Boolean} nesting Handle nesting or not\n\t * @return {Object}          The resolved property value\n\t */\n\tvar getattr = function(obj, name, nesting) {\n\t    if (!obj || !name) return;\n\t    if (!nesting) return obj[name];\n\t    var names = name.split(\".\");\n\t    while(names.length && (obj = obj[names.shift()]));\n\t    return obj;\n\t};\n\n\tvar trim = function(str) {\n\t\treturn (str + '').replace(/^\\s+|\\s+$|/g, '');\n\t};\n\n\tvar escape_regex = function(str) {\n\t\treturn (str + '').replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n\t};\n\n\tvar is_array = Array.isArray || (typeof $ !== 'undefined' && $.isArray) || function(object) {\n\t\treturn Object.prototype.toString.call(object) === '[object Array]';\n\t};\n\n\tvar DIACRITICS = {\n\t\t'a': '[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]',\n\t\t'b': '[b␢βΒB฿𐌁ᛒ]',\n\t\t'c': '[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]',\n\t\t'd': '[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]',\n\t\t'e': '[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]',\n\t\t'f': '[fƑƒḞḟ]',\n\t\t'g': '[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]',\n\t\t'h': '[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]',\n\t\t'i': '[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]',\n\t\t'j': '[jȷĴĵɈɉʝɟʲ]',\n\t\t'k': '[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]',\n\t\t'l': '[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]',\n\t\t'n': '[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]',\n\t\t'o': '[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]',\n\t\t'p': '[pṔṕṖṗⱣᵽƤƥᵱ]',\n\t\t'q': '[qꝖꝗʠɊɋꝘꝙq̃]',\n\t\t'r': '[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]',\n\t\t's': '[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]',\n\t\t't': '[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]',\n\t\t'u': '[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]',\n\t\t'v': '[vṼṽṾṿƲʋꝞꝟⱱʋ]',\n\t\t'w': '[wẂẃẀẁŴŵẄẅẆẇẈẉ]',\n\t\t'x': '[xẌẍẊẋχ]',\n\t\t'y': '[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]',\n\t\t'z': '[zŹźẐẑŽžŻżẒẓẔẕƵƶ]'\n\t};\n\n\tvar asciifold = (function() {\n\t\tvar i, n, k, chunk;\n\t\tvar foreignletters = '';\n\t\tvar lookup = {};\n\t\tfor (k in DIACRITICS) {\n\t\t\tif (DIACRITICS.hasOwnProperty(k)) {\n\t\t\t\tchunk = DIACRITICS[k].substring(2, DIACRITICS[k].length - 1);\n\t\t\t\tforeignletters += chunk;\n\t\t\t\tfor (i = 0, n = chunk.length; i < n; i++) {\n\t\t\t\t\tlookup[chunk.charAt(i)] = k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar regexp = new RegExp('[' +  foreignletters + ']', 'g');\n\t\treturn function(str) {\n\t\t\treturn str.replace(regexp, function(foreignletter) {\n\t\t\t\treturn lookup[foreignletter];\n\t\t\t}).toLowerCase();\n\t\t};\n\t})();\n\n\n\t// export\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\treturn Sifter;\n}));\n\n\n\n/**\n * microplugin.js\n * Copyright (c) 2013 Brian Reavis & contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n * @author Brian Reavis <brian@thirdroute.com>\n */\n\n(function(root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine('microplugin', factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.MicroPlugin = factory();\n\t}\n}(this, function() {\n\tvar MicroPlugin = {};\n\n\tMicroPlugin.mixin = function(Interface) {\n\t\tInterface.plugins = {};\n\n\t\t/**\n\t\t * Initializes the listed plugins (with options).\n\t\t * Acceptable formats:\n\t\t *\n\t\t * List (without options):\n\t\t *   ['a', 'b', 'c']\n\t\t *\n\t\t * List (with options):\n\t\t *   [{'name': 'a', options: {}}, {'name': 'b', options: {}}]\n\t\t *\n\t\t * Hash (with options):\n\t\t *   {'a': { ... }, 'b': { ... }, 'c': { ... }}\n\t\t *\n\t\t * @param {mixed} plugins\n\t\t */\n\t\tInterface.prototype.initializePlugins = function(plugins) {\n\t\t\tvar i, n, key;\n\t\t\tvar self  = this;\n\t\t\tvar queue = [];\n\n\t\t\tself.plugins = {\n\t\t\t\tnames     : [],\n\t\t\t\tsettings  : {},\n\t\t\t\trequested : {},\n\t\t\t\tloaded    : {}\n\t\t\t};\n\n\t\t\tif (utils.isArray(plugins)) {\n\t\t\t\tfor (i = 0, n = plugins.length; i < n; i++) {\n\t\t\t\t\tif (typeof plugins[i] === 'string') {\n\t\t\t\t\t\tqueue.push(plugins[i]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.plugins.settings[plugins[i].name] = plugins[i].options;\n\t\t\t\t\t\tqueue.push(plugins[i].name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (plugins) {\n\t\t\t\tfor (key in plugins) {\n\t\t\t\t\tif (plugins.hasOwnProperty(key)) {\n\t\t\t\t\t\tself.plugins.settings[key] = plugins[key];\n\t\t\t\t\t\tqueue.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twhile (queue.length) {\n\t\t\t\tself.require(queue.shift());\n\t\t\t}\n\t\t};\n\n\t\tInterface.prototype.loadPlugin = function(name) {\n\t\t\tvar self    = this;\n\t\t\tvar plugins = self.plugins;\n\t\t\tvar plugin  = Interface.plugins[name];\n\n\t\t\tif (!Interface.plugins.hasOwnProperty(name)) {\n\t\t\t\tthrow new Error('Unable to find \"' +  name + '\" plugin');\n\t\t\t}\n\n\t\t\tplugins.requested[name] = true;\n\t\t\tplugins.loaded[name] = plugin.fn.apply(self, [self.plugins.settings[name] || {}]);\n\t\t\tplugins.names.push(name);\n\t\t};\n\n\t\t/**\n\t\t * Initializes a plugin.\n\t\t *\n\t\t * @param {string} name\n\t\t */\n\t\tInterface.prototype.require = function(name) {\n\t\t\tvar self = this;\n\t\t\tvar plugins = self.plugins;\n\n\t\t\tif (!self.plugins.loaded.hasOwnProperty(name)) {\n\t\t\t\tif (plugins.requested[name]) {\n\t\t\t\t\tthrow new Error('Plugin has circular dependency (\"' + name + '\")');\n\t\t\t\t}\n\t\t\t\tself.loadPlugin(name);\n\t\t\t}\n\n\t\t\treturn plugins.loaded[name];\n\t\t};\n\n\t\t/**\n\t\t * Registers a plugin.\n\t\t *\n\t\t * @param {string} name\n\t\t * @param {function} fn\n\t\t */\n\t\tInterface.define = function(name, fn) {\n\t\t\tInterface.plugins[name] = {\n\t\t\t\t'name' : name,\n\t\t\t\t'fn'   : fn\n\t\t\t};\n\t\t};\n\t};\n\n\tvar utils = {\n\t\tisArray: Array.isArray || function(vArg) {\n\t\t\treturn Object.prototype.toString.call(vArg) === '[object Array]';\n\t\t}\n\t};\n\n\treturn MicroPlugin;\n}));\n\n/**\n * selectize.js (v0.12.6)\n * Copyright (c) 2013–2015 Brian Reavis & contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n * @author Brian Reavis <brian@thirdroute.com>\n */\n\n/*jshint curly:false */\n/*jshint browser:true */\n\n(function(root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine('selectize', ['jquery','sifter','microplugin'], factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory(require('jquery'), require('sifter'), require('microplugin'));\n\t} else {\n\t\troot.Selectize = factory(root.jQuery, root.Sifter, root.MicroPlugin);\n\t}\n}(this, function($, Sifter, MicroPlugin) {\n\t'use strict';\n\n\tvar highlight = function($element, pattern) {\n\t\tif (typeof pattern === 'string' && !pattern.length) return;\n\t\tvar regex = (typeof pattern === 'string') ? new RegExp(pattern, 'i') : pattern;\n\t\n\t\tvar highlight = function(node) {\n\t\t\tvar skip = 0;\n\t\t\t// Wrap matching part of text node with highlighting <span>, e.g.\n\t\t\t// Soccer  ->  <span class=\"highlight\">Soc</span>cer  for regex = /soc/i\n\t\t\tif (node.nodeType === 3) {\n\t\t\t\tvar pos = node.data.search(regex);\n\t\t\t\tif (pos >= 0 && node.data.length > 0) {\n\t\t\t\t\tvar match = node.data.match(regex);\n\t\t\t\t\tvar spannode = document.createElement('span');\n\t\t\t\t\tspannode.className = 'highlight';\n\t\t\t\t\tvar middlebit = node.splitText(pos);\n\t\t\t\t\tvar endbit = middlebit.splitText(match[0].length);\n\t\t\t\t\tvar middleclone = middlebit.cloneNode(true);\n\t\t\t\t\tspannode.appendChild(middleclone);\n\t\t\t\t\tmiddlebit.parentNode.replaceChild(spannode, middlebit);\n\t\t\t\t\tskip = 1;\n\t\t\t\t}\n\t\t\t} \n\t\t\t// Recurse element node, looking for child text nodes to highlight, unless element \n\t\t\t// is childless, <script>, <style>, or already highlighted: <span class=\"hightlight\">\n\t\t\telse if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName) && ( node.className !== 'highlight' || node.tagName !== 'SPAN' )) {\n\t\t\t\tfor (var i = 0; i < node.childNodes.length; ++i) {\n\t\t\t\t\ti += highlight(node.childNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn skip;\n\t\t};\n\t\n\t\treturn $element.each(function() {\n\t\t\thighlight(this);\n\t\t});\n\t};\n\t\n\t/**\n\t * removeHighlight fn copied from highlight v5 and\n\t * edited to remove with() and pass js strict mode\n\t */\n\t$.fn.removeHighlight = function() {\n\t\treturn this.find(\"span.highlight\").each(function() {\n\t\t\tthis.parentNode.firstChild.nodeName;\n\t\t\tvar parent = this.parentNode;\n\t\t\tparent.replaceChild(this.firstChild, this);\n\t\t\tparent.normalize();\n\t\t}).end();\n\t};\n\t\n\t\n\tvar MicroEvent = function() {};\n\tMicroEvent.prototype = {\n\t\ton: function(event, fct){\n\t\t\tthis._events = this._events || {};\n\t\t\tthis._events[event] = this._events[event] || [];\n\t\t\tthis._events[event].push(fct);\n\t\t},\n\t\toff: function(event, fct){\n\t\t\tvar n = arguments.length;\n\t\t\tif (n === 0) return delete this._events;\n\t\t\tif (n === 1) return delete this._events[event];\n\t\n\t\t\tthis._events = this._events || {};\n\t\t\tif (event in this._events === false) return;\n\t\t\tthis._events[event].splice(this._events[event].indexOf(fct), 1);\n\t\t},\n\t\ttrigger: function(event /* , args... */){\n\t\t\tthis._events = this._events || {};\n\t\t\tif (event in this._events === false) return;\n\t\t\tfor (var i = 0; i < this._events[event].length; i++){\n\t\t\t\tthis._events[event][i].apply(this, Array.prototype.slice.call(arguments, 1));\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t * Mixin will delegate all MicroEvent.js function in the destination object.\n\t *\n\t * - MicroEvent.mixin(Foobar) will make Foobar able to use MicroEvent\n\t *\n\t * @param {object} the object which will support MicroEvent\n\t */\n\tMicroEvent.mixin = function(destObject){\n\t\tvar props = ['on', 'off', 'trigger'];\n\t\tfor (var i = 0; i < props.length; i++){\n\t\t\tdestObject.prototype[props[i]] = MicroEvent.prototype[props[i]];\n\t\t}\n\t};\n\t\n\tvar IS_MAC        = /Mac/.test(navigator.userAgent);\n\t\n\tvar KEY_A         = 65;\n\tvar KEY_COMMA     = 188;\n\tvar KEY_RETURN    = 13;\n\tvar KEY_ESC       = 27;\n\tvar KEY_LEFT      = 37;\n\tvar KEY_UP        = 38;\n\tvar KEY_P         = 80;\n\tvar KEY_RIGHT     = 39;\n\tvar KEY_DOWN      = 40;\n\tvar KEY_N         = 78;\n\tvar KEY_BACKSPACE = 8;\n\tvar KEY_DELETE    = 46;\n\tvar KEY_SHIFT     = 16;\n\tvar KEY_CMD       = IS_MAC ? 91 : 17;\n\tvar KEY_CTRL      = IS_MAC ? 18 : 17;\n\tvar KEY_TAB       = 9;\n\t\n\tvar TAG_SELECT    = 1;\n\tvar TAG_INPUT     = 2;\n\t\n\t// for now, android support in general is too spotty to support validity\n\tvar SUPPORTS_VALIDITY_API = !/android/i.test(window.navigator.userAgent) && !!document.createElement('input').validity;\n\t\n\t\n\tvar isset = function(object) {\n\t\treturn typeof object !== 'undefined';\n\t};\n\t\n\t/**\n\t * Converts a scalar to its best string representation\n\t * for hash keys and HTML attribute values.\n\t *\n\t * Transformations:\n\t *   'str'     -> 'str'\n\t *   null      -> ''\n\t *   undefined -> ''\n\t *   true      -> '1'\n\t *   false     -> '0'\n\t *   0         -> '0'\n\t *   1         -> '1'\n\t *\n\t * @param {string} value\n\t * @returns {string|null}\n\t */\n\tvar hash_key = function(value) {\n\t\tif (typeof value === 'undefined' || value === null) return null;\n\t\tif (typeof value === 'boolean') return value ? '1' : '0';\n\t\treturn value + '';\n\t};\n\t\n\t/**\n\t * Escapes a string for use within HTML.\n\t *\n\t * @param {string} str\n\t * @returns {string}\n\t */\n\tvar escape_html = function(str) {\n\t\treturn (str + '')\n\t\t\t.replace(/&/g, '&amp;')\n\t\t\t.replace(/</g, '&lt;')\n\t\t\t.replace(/>/g, '&gt;')\n\t\t\t.replace(/\"/g, '&quot;');\n\t};\n\t\n\t/**\n\t * Escapes \"$\" characters in replacement strings.\n\t *\n\t * @param {string} str\n\t * @returns {string}\n\t */\n\tvar escape_replace = function(str) {\n\t\treturn (str + '').replace(/\\$/g, '$$$$');\n\t};\n\t\n\tvar hook = {};\n\t\n\t/**\n\t * Wraps `method` on `self` so that `fn`\n\t * is invoked before the original method.\n\t *\n\t * @param {object} self\n\t * @param {string} method\n\t * @param {function} fn\n\t */\n\thook.before = function(self, method, fn) {\n\t\tvar original = self[method];\n\t\tself[method] = function() {\n\t\t\tfn.apply(self, arguments);\n\t\t\treturn original.apply(self, arguments);\n\t\t};\n\t};\n\t\n\t/**\n\t * Wraps `method` on `self` so that `fn`\n\t * is invoked after the original method.\n\t *\n\t * @param {object} self\n\t * @param {string} method\n\t * @param {function} fn\n\t */\n\thook.after = function(self, method, fn) {\n\t\tvar original = self[method];\n\t\tself[method] = function() {\n\t\t\tvar result = original.apply(self, arguments);\n\t\t\tfn.apply(self, arguments);\n\t\t\treturn result;\n\t\t};\n\t};\n\t\n\t/**\n\t * Wraps `fn` so that it can only be invoked once.\n\t *\n\t * @param {function} fn\n\t * @returns {function}\n\t */\n\tvar once = function(fn) {\n\t\tvar called = false;\n\t\treturn function() {\n\t\t\tif (called) return;\n\t\t\tcalled = true;\n\t\t\tfn.apply(this, arguments);\n\t\t};\n\t};\n\t\n\t/**\n\t * Wraps `fn` so that it can only be called once\n\t * every `delay` milliseconds (invoked on the falling edge).\n\t *\n\t * @param {function} fn\n\t * @param {int} delay\n\t * @returns {function}\n\t */\n\tvar debounce = function(fn, delay) {\n\t\tvar timeout;\n\t\treturn function() {\n\t\t\tvar self = this;\n\t\t\tvar args = arguments;\n\t\t\twindow.clearTimeout(timeout);\n\t\t\ttimeout = window.setTimeout(function() {\n\t\t\t\tfn.apply(self, args);\n\t\t\t}, delay);\n\t\t};\n\t};\n\t\n\t/**\n\t * Debounce all fired events types listed in `types`\n\t * while executing the provided `fn`.\n\t *\n\t * @param {object} self\n\t * @param {array} types\n\t * @param {function} fn\n\t */\n\tvar debounce_events = function(self, types, fn) {\n\t\tvar type;\n\t\tvar trigger = self.trigger;\n\t\tvar event_args = {};\n\t\n\t\t// override trigger method\n\t\tself.trigger = function() {\n\t\t\tvar type = arguments[0];\n\t\t\tif (types.indexOf(type) !== -1) {\n\t\t\t\tevent_args[type] = arguments;\n\t\t\t} else {\n\t\t\t\treturn trigger.apply(self, arguments);\n\t\t\t}\n\t\t};\n\t\n\t\t// invoke provided function\n\t\tfn.apply(self, []);\n\t\tself.trigger = trigger;\n\t\n\t\t// trigger queued events\n\t\tfor (type in event_args) {\n\t\t\tif (event_args.hasOwnProperty(type)) {\n\t\t\t\ttrigger.apply(self, event_args[type]);\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t * A workaround for http://bugs.jquery.com/ticket/6696\n\t *\n\t * @param {object} $parent - Parent element to listen on.\n\t * @param {string} event - Event name.\n\t * @param {string} selector - Descendant selector to filter by.\n\t * @param {function} fn - Event handler.\n\t */\n\tvar watchChildEvent = function($parent, event, selector, fn) {\n\t\t$parent.on(event, selector, function(e) {\n\t\t\tvar child = e.target;\n\t\t\twhile (child && child.parentNode !== $parent[0]) {\n\t\t\t\tchild = child.parentNode;\n\t\t\t}\n\t\t\te.currentTarget = child;\n\t\t\treturn fn.apply(this, [e]);\n\t\t});\n\t};\n\t\n\t/**\n\t * Determines the current selection within a text input control.\n\t * Returns an object containing:\n\t *   - start\n\t *   - length\n\t *\n\t * @param {object} input\n\t * @returns {object}\n\t */\n\tvar getSelection = function(input) {\n\t\tvar result = {};\n\t\tif ('selectionStart' in input) {\n\t\t\tresult.start = input.selectionStart;\n\t\t\tresult.length = input.selectionEnd - result.start;\n\t\t} else if (document.selection) {\n\t\t\tinput.focus();\n\t\t\tvar sel = document.selection.createRange();\n\t\t\tvar selLen = document.selection.createRange().text.length;\n\t\t\tsel.moveStart('character', -input.value.length);\n\t\t\tresult.start = sel.text.length - selLen;\n\t\t\tresult.length = selLen;\n\t\t}\n\t\treturn result;\n\t};\n\t\n\t/**\n\t * Copies CSS properties from one element to another.\n\t *\n\t * @param {object} $from\n\t * @param {object} $to\n\t * @param {array} properties\n\t */\n\tvar transferStyles = function($from, $to, properties) {\n\t\tvar i, n, styles = {};\n\t\tif (properties) {\n\t\t\tfor (i = 0, n = properties.length; i < n; i++) {\n\t\t\t\tstyles[properties[i]] = $from.css(properties[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tstyles = $from.css();\n\t\t}\n\t\t$to.css(styles);\n\t};\n\t\n\t/**\n\t * Measures the width of a string within a\n\t * parent element (in pixels).\n\t *\n\t * @param {string} str\n\t * @param {object} $parent\n\t * @returns {int}\n\t */\n\tvar measureString = function(str, $parent) {\n\t\tif (!str) {\n\t\t\treturn 0;\n\t\t}\n\t\n\t\tif (!Selectize.$testInput) {\n\t\t\tSelectize.$testInput = $('<span />').css({\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: -99999,\n\t\t\t\tleft: -99999,\n\t\t\t\twidth: 'auto',\n\t\t\t\tpadding: 0,\n\t\t\t\twhiteSpace: 'pre'\n\t\t\t}).appendTo('body');\n\t\t}\n\t\n\t\tSelectize.$testInput.text(str);\n\t\n\t\ttransferStyles($parent, Selectize.$testInput, [\n\t\t\t'letterSpacing',\n\t\t\t'fontSize',\n\t\t\t'fontFamily',\n\t\t\t'fontWeight',\n\t\t\t'textTransform'\n\t\t]);\n\t\n\t\treturn Selectize.$testInput.width();\n\t};\n\t\n\t/**\n\t * Sets up an input to grow horizontally as the user\n\t * types. If the value is changed manually, you can\n\t * trigger the \"update\" handler to resize:\n\t *\n\t * $input.trigger('update');\n\t *\n\t * @param {object} $input\n\t */\n\tvar autoGrow = function($input) {\n\t\tvar currentWidth = null;\n\t\n\t\tvar update = function(e, options) {\n\t\t\tvar value, keyCode, printable, placeholder, width;\n\t\t\tvar shift, character, selection;\n\t\t\te = e || window.event || {};\n\t\t\toptions = options || {};\n\t\n\t\t\tif (e.metaKey || e.altKey) return;\n\t\t\tif (!options.force && $input.data('grow') === false) return;\n\t\n\t\t\tvalue = $input.val();\n\t\t\tif (e.type && e.type.toLowerCase() === 'keydown') {\n\t\t\t\tkeyCode = e.keyCode;\n\t\t\t\tprintable = (\n\t\t\t\t\t(keyCode >= 48 && keyCode <= 57)  || // 0-9\n\t\t\t\t\t(keyCode >= 65 && keyCode <= 90)   || // a-z\n\t\t\t\t\t(keyCode >= 96 && keyCode <= 111)  || // numpad 0-9, numeric operators\n\t\t\t\t\t(keyCode >= 186 && keyCode <= 222) || // semicolon, equal, comma, dash, etc.\n\t\t\t\t\tkeyCode === 32 // space\n\t\t\t\t);\n\t\n\t\t\t\tif (keyCode === KEY_DELETE || keyCode === KEY_BACKSPACE) {\n\t\t\t\t\tselection = getSelection($input[0]);\n\t\t\t\t\tif (selection.length) {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start) + value.substring(selection.start + selection.length);\n\t\t\t\t\t} else if (keyCode === KEY_BACKSPACE && selection.start) {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start - 1) + value.substring(selection.start + 1);\n\t\t\t\t\t} else if (keyCode === KEY_DELETE && typeof selection.start !== 'undefined') {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start) + value.substring(selection.start + 1);\n\t\t\t\t\t}\n\t\t\t\t} else if (printable) {\n\t\t\t\t\tshift = e.shiftKey;\n\t\t\t\t\tcharacter = String.fromCharCode(e.keyCode);\n\t\t\t\t\tif (shift) character = character.toUpperCase();\n\t\t\t\t\telse character = character.toLowerCase();\n\t\t\t\t\tvalue += character;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tplaceholder = $input.attr('placeholder');\n\t\t\tif (!value && placeholder) {\n\t\t\t\tvalue = placeholder;\n\t\t\t}\n\t\n\t\t\twidth = measureString(value, $input) + 4;\n\t\t\tif (width !== currentWidth) {\n\t\t\t\tcurrentWidth = width;\n\t\t\t\t$input.width(width);\n\t\t\t\t$input.triggerHandler('resize');\n\t\t\t}\n\t\t};\n\t\n\t\t$input.on('keydown keyup update blur', update);\n\t\tupdate();\n\t};\n\t\n\tvar domToString = function(d) {\n\t\tvar tmp = document.createElement('div');\n\t\n\t\ttmp.appendChild(d.cloneNode(true));\n\t\n\t\treturn tmp.innerHTML;\n\t};\n\t\n\tvar logError = function(message, options){\n\t\tif(!options) options = {};\n\t\tvar component = \"Selectize\";\n\t\n\t\tconsole.error(component + \": \" + message)\n\t\n\t\tif(options.explanation){\n\t\t\t// console.group is undefined in <IE11\n\t\t\tif(console.group) console.group();\n\t\t\tconsole.error(options.explanation);\n\t\t\tif(console.group) console.groupEnd();\n\t\t}\n\t}\n\t\n\t\n\tvar Selectize = function($input, settings) {\n\t\tvar key, i, n, dir, input, self = this;\n\t\tinput = $input[0];\n\t\tinput.selectize = self;\n\t\n\t\t// detect rtl environment\n\t\tvar computedStyle = window.getComputedStyle && window.getComputedStyle(input, null);\n\t\tdir = computedStyle ? computedStyle.getPropertyValue('direction') : input.currentStyle && input.currentStyle.direction;\n\t\tdir = dir || $input.parents('[dir]:first').attr('dir') || '';\n\t\n\t\t// setup default state\n\t\t$.extend(self, {\n\t\t\torder            : 0,\n\t\t\tsettings         : settings,\n\t\t\t$input           : $input,\n\t\t\ttabIndex         : $input.attr('tabindex') || '',\n\t\t\ttagType          : input.tagName.toLowerCase() === 'select' ? TAG_SELECT : TAG_INPUT,\n\t\t\trtl              : /rtl/i.test(dir),\n\t\n\t\t\teventNS          : '.selectize' + (++Selectize.count),\n\t\t\thighlightedValue : null,\n\t\t\tisBlurring       : false,\n\t\t\tisOpen           : false,\n\t\t\tisDisabled       : false,\n\t\t\tisRequired       : $input.is('[required]'),\n\t\t\tisInvalid        : false,\n\t\t\tisLocked         : false,\n\t\t\tisFocused        : false,\n\t\t\tisInputHidden    : false,\n\t\t\tisSetup          : false,\n\t\t\tisShiftDown      : false,\n\t\t\tisCmdDown        : false,\n\t\t\tisCtrlDown       : false,\n\t\t\tignoreFocus      : false,\n\t\t\tignoreBlur       : false,\n\t\t\tignoreHover      : false,\n\t\t\thasOptions       : false,\n\t\t\tcurrentResults   : null,\n\t\t\tlastValue        : '',\n\t\t\tcaretPos         : 0,\n\t\t\tloading          : 0,\n\t\t\tloadedSearches   : {},\n\t\n\t\t\t$activeOption    : null,\n\t\t\t$activeItems     : [],\n\t\n\t\t\toptgroups        : {},\n\t\t\toptions          : {},\n\t\t\tuserOptions      : {},\n\t\t\titems            : [],\n\t\t\trenderCache      : {},\n\t\t\tonSearchChange   : settings.loadThrottle === null ? self.onSearchChange : debounce(self.onSearchChange, settings.loadThrottle)\n\t\t});\n\t\n\t\t// search system\n\t\tself.sifter = new Sifter(this.options, {diacritics: settings.diacritics});\n\t\n\t\t// build options table\n\t\tif (self.settings.options) {\n\t\t\tfor (i = 0, n = self.settings.options.length; i < n; i++) {\n\t\t\t\tself.registerOption(self.settings.options[i]);\n\t\t\t}\n\t\t\tdelete self.settings.options;\n\t\t}\n\t\n\t\t// build optgroup table\n\t\tif (self.settings.optgroups) {\n\t\t\tfor (i = 0, n = self.settings.optgroups.length; i < n; i++) {\n\t\t\t\tself.registerOptionGroup(self.settings.optgroups[i]);\n\t\t\t}\n\t\t\tdelete self.settings.optgroups;\n\t\t}\n\t\n\t\t// option-dependent defaults\n\t\tself.settings.mode = self.settings.mode || (self.settings.maxItems === 1 ? 'single' : 'multi');\n\t\tif (typeof self.settings.hideSelected !== 'boolean') {\n\t\t\tself.settings.hideSelected = self.settings.mode === 'multi';\n\t\t}\n\t\n\t\tself.initializePlugins(self.settings.plugins);\n\t\tself.setupCallbacks();\n\t\tself.setupTemplates();\n\t\tself.setup();\n\t};\n\t\n\t// mixins\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\t\n\tMicroEvent.mixin(Selectize);\n\t\n\tif(typeof MicroPlugin !== \"undefined\"){\n\t\tMicroPlugin.mixin(Selectize);\n\t}else{\n\t\tlogError(\"Dependency MicroPlugin is missing\",\n\t\t\t{explanation:\n\t\t\t\t\"Make sure you either: (1) are using the \\\"standalone\\\" \"+\n\t\t\t\t\"version of Selectize, or (2) require MicroPlugin before you \"+\n\t\t\t\t\"load Selectize.\"}\n\t\t);\n\t}\n\t\n\t\n\t// methods\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\t\n\t$.extend(Selectize.prototype, {\n\t\n\t\t/**\n\t\t * Creates all elements and sets up event bindings.\n\t\t */\n\t\tsetup: function() {\n\t\t\tvar self      = this;\n\t\t\tvar settings  = self.settings;\n\t\t\tvar eventNS   = self.eventNS;\n\t\t\tvar $window   = $(window);\n\t\t\tvar $document = $(document);\n\t\t\tvar $input    = self.$input;\n\t\n\t\t\tvar $wrapper;\n\t\t\tvar $control;\n\t\t\tvar $control_input;\n\t\t\tvar $dropdown;\n\t\t\tvar $dropdown_content;\n\t\t\tvar $dropdown_parent;\n\t\t\tvar inputMode;\n\t\t\tvar timeout_blur;\n\t\t\tvar timeout_focus;\n\t\t\tvar classes;\n\t\t\tvar classes_plugins;\n\t\t\tvar inputId;\n\t\n\t\t\tinputMode         = self.settings.mode;\n\t\t\tclasses           = $input.attr('class') || '';\n\t\n\t\t\t$wrapper          = $('<div>').addClass(settings.wrapperClass).addClass(classes).addClass(inputMode);\n\t\t\t$control          = $('<div>').addClass(settings.inputClass).addClass('items').appendTo($wrapper);\n\t\t\t$control_input    = $('<input type=\"text\" autocomplete=\"off\" />').appendTo($control).attr('tabindex', $input.is(':disabled') ? '-1' : self.tabIndex);\n\t\t\t$dropdown_parent  = $(settings.dropdownParent || $wrapper);\n\t\t\t$dropdown         = $('<div>').addClass(settings.dropdownClass).addClass(inputMode).hide().appendTo($dropdown_parent);\n\t\t\t$dropdown_content = $('<div>').addClass(settings.dropdownContentClass).appendTo($dropdown);\n\t\n\t\t\tif(inputId = $input.attr('id')) {\n\t\t\t\t$control_input.attr('id', inputId + '-selectized');\n\t\t\t\t$(\"label[for='\"+inputId+\"']\").attr('for', inputId + '-selectized');\n\t\t\t}\n\t\n\t\t\tif(self.settings.copyClassesToDropdown) {\n\t\t\t\t$dropdown.addClass(classes);\n\t\t\t}\n\t\n\t\t\t$wrapper.css({\n\t\t\t\twidth: $input[0].style.width\n\t\t\t});\n\t\n\t\t\tif (self.plugins.names.length) {\n\t\t\t\tclasses_plugins = 'plugin-' + self.plugins.names.join(' plugin-');\n\t\t\t\t$wrapper.addClass(classes_plugins);\n\t\t\t\t$dropdown.addClass(classes_plugins);\n\t\t\t}\n\t\n\t\t\tif ((settings.maxItems === null || settings.maxItems > 1) && self.tagType === TAG_SELECT) {\n\t\t\t\t$input.attr('multiple', 'multiple');\n\t\t\t}\n\t\n\t\t\tif (self.settings.placeholder) {\n\t\t\t\t$control_input.attr('placeholder', settings.placeholder);\n\t\t\t}\n\t\n\t\t\t// if splitOn was not passed in, construct it from the delimiter to allow pasting universally\n\t\t\tif (!self.settings.splitOn && self.settings.delimiter) {\n\t\t\t\tvar delimiterEscaped = self.settings.delimiter.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t\t\t\tself.settings.splitOn = new RegExp('\\\\s*' + delimiterEscaped + '+\\\\s*');\n\t\t\t}\n\t\n\t\t\tif ($input.attr('autocorrect')) {\n\t\t\t\t$control_input.attr('autocorrect', $input.attr('autocorrect'));\n\t\t\t}\n\t\n\t\t\tif ($input.attr('autocapitalize')) {\n\t\t\t\t$control_input.attr('autocapitalize', $input.attr('autocapitalize'));\n\t\t\t}\n\t\t\t$control_input[0].type = $input[0].type;\n\t\n\t\t\tself.$wrapper          = $wrapper;\n\t\t\tself.$control          = $control;\n\t\t\tself.$control_input    = $control_input;\n\t\t\tself.$dropdown         = $dropdown;\n\t\t\tself.$dropdown_content = $dropdown_content;\n\t\n\t\t\t$dropdown.on('mouseenter mousedown click', '[data-disabled]>[data-selectable]', function(e) { e.stopImmediatePropagation(); });\n\t\t\t$dropdown.on('mouseenter', '[data-selectable]', function() { return self.onOptionHover.apply(self, arguments); });\n\t\t\t$dropdown.on('mousedown click', '[data-selectable]', function() { return self.onOptionSelect.apply(self, arguments); });\n\t\t\twatchChildEvent($control, 'mousedown', '*:not(input)', function() { return self.onItemSelect.apply(self, arguments); });\n\t\t\tautoGrow($control_input);\n\t\n\t\t\t$control.on({\n\t\t\t\tmousedown : function() { return self.onMouseDown.apply(self, arguments); },\n\t\t\t\tclick     : function() { return self.onClick.apply(self, arguments); }\n\t\t\t});\n\t\n\t\t\t$control_input.on({\n\t\t\t\tmousedown : function(e) { e.stopPropagation(); },\n\t\t\t\tkeydown   : function() { return self.onKeyDown.apply(self, arguments); },\n\t\t\t\tkeyup     : function() { return self.onKeyUp.apply(self, arguments); },\n\t\t\t\tkeypress  : function() { return self.onKeyPress.apply(self, arguments); },\n\t\t\t\tresize    : function() { self.positionDropdown.apply(self, []); },\n\t\t\t\tblur      : function() { return self.onBlur.apply(self, arguments); },\n\t\t\t\tfocus     : function() { self.ignoreBlur = false; return self.onFocus.apply(self, arguments); },\n\t\t\t\tpaste     : function() { return self.onPaste.apply(self, arguments); }\n\t\t\t});\n\t\n\t\t\t$document.on('keydown' + eventNS, function(e) {\n\t\t\t\tself.isCmdDown = e[IS_MAC ? 'metaKey' : 'ctrlKey'];\n\t\t\t\tself.isCtrlDown = e[IS_MAC ? 'altKey' : 'ctrlKey'];\n\t\t\t\tself.isShiftDown = e.shiftKey;\n\t\t\t});\n\t\n\t\t\t$document.on('keyup' + eventNS, function(e) {\n\t\t\t\tif (e.keyCode === KEY_CTRL) self.isCtrlDown = false;\n\t\t\t\tif (e.keyCode === KEY_SHIFT) self.isShiftDown = false;\n\t\t\t\tif (e.keyCode === KEY_CMD) self.isCmdDown = false;\n\t\t\t});\n\t\n\t\t\t$document.on('mousedown' + eventNS, function(e) {\n\t\t\t\tif (self.isFocused) {\n\t\t\t\t\t// prevent events on the dropdown scrollbar from causing the control to blur\n\t\t\t\t\tif (e.target === self.$dropdown[0] || e.target.parentNode === self.$dropdown[0]) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t// blur on click outside\n\t\t\t\t\tif (!self.$control.has(e.target).length && e.target !== self.$control[0]) {\n\t\t\t\t\t\tself.blur(e.target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\t$window.on(['scroll' + eventNS, 'resize' + eventNS].join(' '), function() {\n\t\t\t\tif (self.isOpen) {\n\t\t\t\t\tself.positionDropdown.apply(self, arguments);\n\t\t\t\t}\n\t\t\t});\n\t\t\t$window.on('mousemove' + eventNS, function() {\n\t\t\t\tself.ignoreHover = false;\n\t\t\t});\n\t\n\t\t\t// store original children and tab index so that they can be\n\t\t\t// restored when the destroy() method is called.\n\t\t\tthis.revertSettings = {\n\t\t\t\t$children : $input.children().detach(),\n\t\t\t\ttabindex  : $input.attr('tabindex')\n\t\t\t};\n\t\n\t\t\t$input.attr('tabindex', -1).hide().after(self.$wrapper);\n\t\n\t\t\tif ($.isArray(settings.items)) {\n\t\t\t\tself.setValue(settings.items);\n\t\t\t\tdelete settings.items;\n\t\t\t}\n\t\n\t\t\t// feature detect for the validation API\n\t\t\tif (SUPPORTS_VALIDITY_API) {\n\t\t\t\t$input.on('invalid' + eventNS, function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tself.isInvalid = true;\n\t\t\t\t\tself.refreshState();\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\tself.updateOriginalInput();\n\t\t\tself.refreshItems();\n\t\t\tself.refreshState();\n\t\t\tself.updatePlaceholder();\n\t\t\tself.isSetup = true;\n\t\n\t\t\tif ($input.is(':disabled')) {\n\t\t\t\tself.disable();\n\t\t\t}\n\t\n\t\t\tself.on('change', this.onChange);\n\t\n\t\t\t$input.data('selectize', self);\n\t\t\t$input.addClass('selectized');\n\t\t\tself.trigger('initialize');\n\t\n\t\t\t// preload options\n\t\t\tif (settings.preload === true) {\n\t\t\t\tself.onSearchChange('');\n\t\t\t}\n\t\n\t\t},\n\t\n\t\t/**\n\t\t * Sets up default rendering functions.\n\t\t */\n\t\tsetupTemplates: function() {\n\t\t\tvar self = this;\n\t\t\tvar field_label = self.settings.labelField;\n\t\t\tvar field_optgroup = self.settings.optgroupLabelField;\n\t\n\t\t\tvar templates = {\n\t\t\t\t'optgroup': function(data) {\n\t\t\t\t\treturn '<div class=\"optgroup\">' + data.html + '</div>';\n\t\t\t\t},\n\t\t\t\t'optgroup_header': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"optgroup-header\">' + escape(data[field_optgroup]) + '</div>';\n\t\t\t\t},\n\t\t\t\t'option': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"option\">' + escape(data[field_label]) + '</div>';\n\t\t\t\t},\n\t\t\t\t'item': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"item\">' + escape(data[field_label]) + '</div>';\n\t\t\t\t},\n\t\t\t\t'option_create': function(data, escape) {\n\t\t\t\t\treturn '<div class=\"create\">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>';\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tself.settings.render = $.extend({}, templates, self.settings.render);\n\t\t},\n\t\n\t\t/**\n\t\t * Maps fired events to callbacks provided\n\t\t * in the settings used when creating the control.\n\t\t */\n\t\tsetupCallbacks: function() {\n\t\t\tvar key, fn, callbacks = {\n\t\t\t\t'initialize'      : 'onInitialize',\n\t\t\t\t'change'          : 'onChange',\n\t\t\t\t'item_add'        : 'onItemAdd',\n\t\t\t\t'item_remove'     : 'onItemRemove',\n\t\t\t\t'clear'           : 'onClear',\n\t\t\t\t'option_add'      : 'onOptionAdd',\n\t\t\t\t'option_remove'   : 'onOptionRemove',\n\t\t\t\t'option_clear'    : 'onOptionClear',\n\t\t\t\t'optgroup_add'    : 'onOptionGroupAdd',\n\t\t\t\t'optgroup_remove' : 'onOptionGroupRemove',\n\t\t\t\t'optgroup_clear'  : 'onOptionGroupClear',\n\t\t\t\t'dropdown_open'   : 'onDropdownOpen',\n\t\t\t\t'dropdown_close'  : 'onDropdownClose',\n\t\t\t\t'type'            : 'onType',\n\t\t\t\t'load'            : 'onLoad',\n\t\t\t\t'focus'           : 'onFocus',\n\t\t\t\t'blur'            : 'onBlur'\n\t\t\t};\n\t\n\t\t\tfor (key in callbacks) {\n\t\t\t\tif (callbacks.hasOwnProperty(key)) {\n\t\t\t\t\tfn = this.settings[callbacks[key]];\n\t\t\t\t\tif (fn) this.on(key, fn);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the main control element\n\t\t * has a click event.\n\t\t *\n\t\t * @param {object} e\n\t\t * @return {boolean}\n\t\t */\n\t\tonClick: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\t// necessary for mobile webkit devices (manual focus triggering\n\t\t\t// is ignored unless invoked within a click event)\n\t    // also necessary to reopen a dropdown that has been closed by\n\t    // closeAfterSelect\n\t\t\tif (!self.isFocused || !self.isOpen) {\n\t\t\t\tself.focus();\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the main control element\n\t\t * has a mouse down event.\n\t\t *\n\t\t * @param {object} e\n\t\t * @return {boolean}\n\t\t */\n\t\tonMouseDown: function(e) {\n\t\t\tvar self = this;\n\t\t\tvar defaultPrevented = e.isDefaultPrevented();\n\t\t\tvar $target = $(e.target);\n\t\n\t\t\tif (self.isFocused) {\n\t\t\t\t// retain focus by preventing native handling. if the\n\t\t\t\t// event target is the input it should not be modified.\n\t\t\t\t// otherwise, text selection within the input won't work.\n\t\t\t\tif (e.target !== self.$control_input[0]) {\n\t\t\t\t\tif (self.settings.mode === 'single') {\n\t\t\t\t\t\t// toggle dropdown\n\t\t\t\t\t\tself.isOpen ? self.close() : self.open();\n\t\t\t\t\t} else if (!defaultPrevented) {\n\t\t\t\t\t\tself.setActiveItem(null);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// give control focus\n\t\t\t\tif (!defaultPrevented) {\n\t\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\t\tself.focus();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the value of the control has been changed.\n\t\t * This should propagate the event to the original DOM\n\t\t * input / select element.\n\t\t */\n\t\tonChange: function() {\n\t\t\tthis.$input.trigger('change');\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> paste.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonPaste: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isFull() || self.isInputHidden || self.isLocked) {\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t// If a regex or string is included, this will split the pasted\n\t\t\t// input and create Items for each separate value\n\t\t\tif (self.settings.splitOn) {\n\t\n\t\t\t\t// Wait for pasted text to be recognized in value\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tvar pastedText = self.$control_input.val();\n\t\t\t\t\tif(!pastedText.match(self.settings.splitOn)){ return }\n\t\n\t\t\t\t\tvar splitInput = $.trim(pastedText).split(self.settings.splitOn);\n\t\t\t\t\tfor (var i = 0, n = splitInput.length; i < n; i++) {\n\t\t\t\t\t\tself.createItem(splitInput[i]);\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> keypress.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonKeyPress: function(e) {\n\t\t\tif (this.isLocked) return e && e.preventDefault();\n\t\t\tvar character = String.fromCharCode(e.keyCode || e.which);\n\t\t\tif (this.settings.create && this.settings.mode === 'multi' && character === this.settings.delimiter) {\n\t\t\t\tthis.createItem();\n\t\t\t\te.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> keydown.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonKeyDown: function(e) {\n\t\t\tvar isInput = e.target === this.$control_input[0];\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked) {\n\t\t\t\tif (e.keyCode !== KEY_TAB) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase KEY_A:\n\t\t\t\t\tif (self.isCmdDown) {\n\t\t\t\t\t\tself.selectAll();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_ESC:\n\t\t\t\t\tif (self.isOpen) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_N:\n\t\t\t\t\tif (!e.ctrlKey || e.altKey) break;\n\t\t\t\tcase KEY_DOWN:\n\t\t\t\t\tif (!self.isOpen && self.hasOptions) {\n\t\t\t\t\t\tself.open();\n\t\t\t\t\t} else if (self.$activeOption) {\n\t\t\t\t\t\tself.ignoreHover = true;\n\t\t\t\t\t\tvar $next = self.getAdjacentOption(self.$activeOption, 1);\n\t\t\t\t\t\tif ($next.length) self.setActiveOption($next, true, true);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_P:\n\t\t\t\t\tif (!e.ctrlKey || e.altKey) break;\n\t\t\t\tcase KEY_UP:\n\t\t\t\t\tif (self.$activeOption) {\n\t\t\t\t\t\tself.ignoreHover = true;\n\t\t\t\t\t\tvar $prev = self.getAdjacentOption(self.$activeOption, -1);\n\t\t\t\t\t\tif ($prev.length) self.setActiveOption($prev, true, true);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_RETURN:\n\t\t\t\t\tif (self.isOpen && self.$activeOption) {\n\t\t\t\t\t\tself.onOptionSelect({currentTarget: self.$activeOption});\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_LEFT:\n\t\t\t\t\tself.advanceSelection(-1, e);\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_RIGHT:\n\t\t\t\t\tself.advanceSelection(1, e);\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_TAB:\n\t\t\t\t\tif (self.settings.selectOnTab && self.isOpen && self.$activeOption) {\n\t\t\t\t\t\tself.onOptionSelect({currentTarget: self.$activeOption});\n\t\n\t\t\t\t\t\t// Default behaviour is to jump to the next field, we only want this\n\t\t\t\t\t\t// if the current field doesn't accept any more entries\n\t\t\t\t\t\tif (!self.isFull()) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (self.settings.create && self.createItem()) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\tcase KEY_BACKSPACE:\n\t\t\t\tcase KEY_DELETE:\n\t\t\t\t\tself.deleteSelection(e);\n\t\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif ((self.isFull() || self.isInputHidden) && !(IS_MAC ? e.metaKey : e.ctrlKey)) {\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> keyup.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonKeyUp: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked) return e && e.preventDefault();\n\t\t\tvar value = self.$control_input.val() || '';\n\t\t\tif (self.lastValue !== value) {\n\t\t\t\tself.lastValue = value;\n\t\t\t\tself.onSearchChange(value);\n\t\t\t\tself.refreshOptions();\n\t\t\t\tself.trigger('type', value);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Invokes the user-provide option provider / loader.\n\t\t *\n\t\t * Note: this function is debounced in the Selectize\n\t\t * constructor (by `settings.loadThrottle` milliseconds)\n\t\t *\n\t\t * @param {string} value\n\t\t */\n\t\tonSearchChange: function(value) {\n\t\t\tvar self = this;\n\t\t\tvar fn = self.settings.load;\n\t\t\tif (!fn) return;\n\t\t\tif (self.loadedSearches.hasOwnProperty(value)) return;\n\t\t\tself.loadedSearches[value] = true;\n\t\t\tself.load(function(callback) {\n\t\t\t\tfn.apply(self, [value, callback]);\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> focus.\n\t\t *\n\t\t * @param {object} e (optional)\n\t\t * @returns {boolean}\n\t\t */\n\t\tonFocus: function(e) {\n\t\t\tvar self = this;\n\t\t\tvar wasFocused = self.isFocused;\n\t\n\t\t\tif (self.isDisabled) {\n\t\t\t\tself.blur();\n\t\t\t\te && e.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tif (self.ignoreFocus) return;\n\t\t\tself.isFocused = true;\n\t\t\tif (self.settings.preload === 'focus') self.onSearchChange('');\n\t\n\t\t\tif (!wasFocused) self.trigger('focus');\n\t\n\t\t\tif (!self.$activeItems.length) {\n\t\t\t\tself.showInput();\n\t\t\t\tself.setActiveItem(null);\n\t\t\t\tself.refreshOptions(!!self.settings.openOnFocus);\n\t\t\t}\n\t\n\t\t\tself.refreshState();\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered on <input> blur.\n\t\t *\n\t\t * @param {object} e\n\t\t * @param {Element} dest\n\t\t */\n\t\tonBlur: function(e, dest) {\n\t\t\tvar self = this;\n\t\t\tif (!self.isFocused) return;\n\t\t\tself.isFocused = false;\n\t\n\t\t\tif (self.ignoreFocus) {\n\t\t\t\treturn;\n\t\t\t} else if (!self.ignoreBlur && document.activeElement === self.$dropdown_content[0]) {\n\t\t\t\t// necessary to prevent IE closing the dropdown when the scrollbar is clicked\n\t\t\t\tself.ignoreBlur = true;\n\t\t\t\tself.onFocus(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tvar deactivate = function() {\n\t\t\t\tself.close();\n\t\t\t\tself.setTextboxValue('');\n\t\t\t\tself.setActiveItem(null);\n\t\t\t\tself.setActiveOption(null);\n\t\t\t\tself.setCaret(self.items.length);\n\t\t\t\tself.refreshState();\n\t\n\t\t\t\t// IE11 bug: element still marked as active\n\t\t\t\tdest && dest.focus && dest.focus();\n\t\n\t\t\t\tself.isBlurring = false;\n\t\t\t\tself.ignoreFocus = false;\n\t\t\t\tself.trigger('blur');\n\t\t\t};\n\t\n\t\t\tself.isBlurring = true;\n\t\t\tself.ignoreFocus = true;\n\t\t\tif (self.settings.create && self.settings.createOnBlur) {\n\t\t\t\tself.createItem(null, false, deactivate);\n\t\t\t} else {\n\t\t\t\tdeactivate();\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the user rolls over\n\t\t * an option in the autocomplete dropdown menu.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonOptionHover: function(e) {\n\t\t\tif (this.ignoreHover) return;\n\t\t\tthis.setActiveOption(e.currentTarget, false);\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the user clicks on an option\n\t\t * in the autocomplete dropdown menu.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonOptionSelect: function(e) {\n\t\t\tvar value, $target, $option, self = this;\n\t\n\t\t\tif (e.preventDefault) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\n\t\t\t$target = $(e.currentTarget);\n\t\t\tif ($target.hasClass('create')) {\n\t\t\t\tself.createItem(null, function() {\n\t\t\t\t\tif (self.settings.closeAfterSelect) {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvalue = $target.attr('data-value');\n\t\t\t\tif (typeof value !== 'undefined') {\n\t\t\t\t\tself.lastQuery = null;\n\t\t\t\t\tself.setTextboxValue('');\n\t\t\t\t\tself.addItem(value);\n\t\t\t\t\tif (self.settings.closeAfterSelect) {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t} else if (!self.settings.hideSelected && e.type && /mouse/.test(e.type)) {\n\t\t\t\t\t\tself.setActiveOption(self.getOption(value));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Triggered when the user clicks on an item\n\t\t * that has been selected.\n\t\t *\n\t\t * @param {object} e\n\t\t * @returns {boolean}\n\t\t */\n\t\tonItemSelect: function(e) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked) return;\n\t\t\tif (self.settings.mode === 'multi') {\n\t\t\t\te.preventDefault();\n\t\t\t\tself.setActiveItem(e.currentTarget, e);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Invokes the provided method that provides\n\t\t * results to a callback---which are then added\n\t\t * as options to the control.\n\t\t *\n\t\t * @param {function} fn\n\t\t */\n\t\tload: function(fn) {\n\t\t\tvar self = this;\n\t\t\tvar $wrapper = self.$wrapper.addClass(self.settings.loadingClass);\n\t\n\t\t\tself.loading++;\n\t\t\tfn.apply(self, [function(results) {\n\t\t\t\tself.loading = Math.max(self.loading - 1, 0);\n\t\t\t\tif (results && results.length) {\n\t\t\t\t\tself.addOption(results);\n\t\t\t\t\tself.refreshOptions(self.isFocused && !self.isInputHidden);\n\t\t\t\t}\n\t\t\t\tif (!self.loading) {\n\t\t\t\t\t$wrapper.removeClass(self.settings.loadingClass);\n\t\t\t\t}\n\t\t\t\tself.trigger('load', results);\n\t\t\t}]);\n\t\t},\n\t\n\t\t/**\n\t\t * Sets the input field of the control to the specified value.\n\t\t *\n\t\t * @param {string} value\n\t\t */\n\t\tsetTextboxValue: function(value) {\n\t\t\tvar $input = this.$control_input;\n\t\t\tvar changed = $input.val() !== value;\n\t\t\tif (changed) {\n\t\t\t\t$input.val(value).triggerHandler('update');\n\t\t\t\tthis.lastValue = value;\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the value of the control. If multiple items\n\t\t * can be selected (e.g. <select multiple>), this returns\n\t\t * an array. If only one item can be selected, this\n\t\t * returns a string.\n\t\t *\n\t\t * @returns {mixed}\n\t\t */\n\t\tgetValue: function() {\n\t\t\tif (this.tagType === TAG_SELECT && this.$input.attr('multiple')) {\n\t\t\t\treturn this.items;\n\t\t\t} else {\n\t\t\t\treturn this.items.join(this.settings.delimiter);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Resets the selected items to the given value.\n\t\t *\n\t\t * @param {mixed} value\n\t\t */\n\t\tsetValue: function(value, silent) {\n\t\t\tvar events = silent ? [] : ['change'];\n\t\n\t\t\tdebounce_events(this, events, function() {\n\t\t\t\tthis.clear(silent);\n\t\t\t\tthis.addItems(value, silent);\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Sets the selected item.\n\t\t *\n\t\t * @param {object} $item\n\t\t * @param {object} e (optional)\n\t\t */\n\t\tsetActiveItem: function($item, e) {\n\t\t\tvar self = this;\n\t\t\tvar eventName;\n\t\t\tvar i, idx, begin, end, item, swap;\n\t\t\tvar $last;\n\t\n\t\t\tif (self.settings.mode === 'single') return;\n\t\t\t$item = $($item);\n\t\n\t\t\t// clear the active selection\n\t\t\tif (!$item.length) {\n\t\t\t\t$(self.$activeItems).removeClass('active');\n\t\t\t\tself.$activeItems = [];\n\t\t\t\tif (self.isFocused) {\n\t\t\t\t\tself.showInput();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\t// modify selection\n\t\t\teventName = e && e.type.toLowerCase();\n\t\n\t\t\tif (eventName === 'mousedown' && self.isShiftDown && self.$activeItems.length) {\n\t\t\t\t$last = self.$control.children('.active:last');\n\t\t\t\tbegin = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$last[0]]);\n\t\t\t\tend   = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$item[0]]);\n\t\t\t\tif (begin > end) {\n\t\t\t\t\tswap  = begin;\n\t\t\t\t\tbegin = end;\n\t\t\t\t\tend   = swap;\n\t\t\t\t}\n\t\t\t\tfor (i = begin; i <= end; i++) {\n\t\t\t\t\titem = self.$control[0].childNodes[i];\n\t\t\t\t\tif (self.$activeItems.indexOf(item) === -1) {\n\t\t\t\t\t\t$(item).addClass('active');\n\t\t\t\t\t\tself.$activeItems.push(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t} else if ((eventName === 'mousedown' && self.isCtrlDown) || (eventName === 'keydown' && this.isShiftDown)) {\n\t\t\t\tif ($item.hasClass('active')) {\n\t\t\t\t\tidx = self.$activeItems.indexOf($item[0]);\n\t\t\t\t\tself.$activeItems.splice(idx, 1);\n\t\t\t\t\t$item.removeClass('active');\n\t\t\t\t} else {\n\t\t\t\t\tself.$activeItems.push($item.addClass('active')[0]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$(self.$activeItems).removeClass('active');\n\t\t\t\tself.$activeItems = [$item.addClass('active')[0]];\n\t\t\t}\n\t\n\t\t\t// ensure control has focus\n\t\t\tself.hideInput();\n\t\t\tif (!this.isFocused) {\n\t\t\t\tself.focus();\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Sets the selected item in the dropdown menu\n\t\t * of available options.\n\t\t *\n\t\t * @param {object} $object\n\t\t * @param {boolean} scroll\n\t\t * @param {boolean} animate\n\t\t */\n\t\tsetActiveOption: function($option, scroll, animate) {\n\t\t\tvar height_menu, height_item, y;\n\t\t\tvar scroll_top, scroll_bottom;\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.$activeOption) self.$activeOption.removeClass('active');\n\t\t\tself.$activeOption = null;\n\t\n\t\t\t$option = $($option);\n\t\t\tif (!$option.length) return;\n\t\n\t\t\tself.$activeOption = $option.addClass('active');\n\t\n\t\t\tif (scroll || !isset(scroll)) {\n\t\n\t\t\t\theight_menu   = self.$dropdown_content.height();\n\t\t\t\theight_item   = self.$activeOption.outerHeight(true);\n\t\t\t\tscroll        = self.$dropdown_content.scrollTop() || 0;\n\t\t\t\ty             = self.$activeOption.offset().top - self.$dropdown_content.offset().top + scroll;\n\t\t\t\tscroll_top    = y;\n\t\t\t\tscroll_bottom = y - height_menu + height_item;\n\t\n\t\t\t\tif (y + height_item > height_menu + scroll) {\n\t\t\t\t\tself.$dropdown_content.stop().animate({scrollTop: scroll_bottom}, animate ? self.settings.scrollDuration : 0);\n\t\t\t\t} else if (y < scroll) {\n\t\t\t\t\tself.$dropdown_content.stop().animate({scrollTop: scroll_top}, animate ? self.settings.scrollDuration : 0);\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Selects all items (CTRL + A).\n\t\t */\n\t\tselectAll: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.settings.mode === 'single') return;\n\t\n\t\t\tself.$activeItems = Array.prototype.slice.apply(self.$control.children(':not(input)').addClass('active'));\n\t\t\tif (self.$activeItems.length) {\n\t\t\t\tself.hideInput();\n\t\t\t\tself.close();\n\t\t\t}\n\t\t\tself.focus();\n\t\t},\n\t\n\t\t/**\n\t\t * Hides the input element out of view, while\n\t\t * retaining its focus.\n\t\t */\n\t\thideInput: function() {\n\t\t\tvar self = this;\n\t\n\t\t\tself.setTextboxValue('');\n\t\t\tself.$control_input.css({opacity: 0, position: 'absolute', left: self.rtl ? 10000 : -10000});\n\t\t\tself.isInputHidden = true;\n\t\t},\n\t\n\t\t/**\n\t\t * Restores input visibility.\n\t\t */\n\t\tshowInput: function() {\n\t\t\tthis.$control_input.css({opacity: 1, position: 'relative', left: 0});\n\t\t\tthis.isInputHidden = false;\n\t\t},\n\t\n\t\t/**\n\t\t * Gives the control focus.\n\t\t */\n\t\tfocus: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.isDisabled) return;\n\t\n\t\t\tself.ignoreFocus = true;\n\t\t\tself.$control_input[0].focus();\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tself.ignoreFocus = false;\n\t\t\t\tself.onFocus();\n\t\t\t}, 0);\n\t\t},\n\t\n\t\t/**\n\t\t * Forces the control out of focus.\n\t\t *\n\t\t * @param {Element} dest\n\t\t */\n\t\tblur: function(dest) {\n\t\t\tthis.$control_input[0].blur();\n\t\t\tthis.onBlur(null, dest);\n\t\t},\n\t\n\t\t/**\n\t\t * Returns a function that scores an object\n\t\t * to show how good of a match it is to the\n\t\t * provided query.\n\t\t *\n\t\t * @param {string} query\n\t\t * @param {object} options\n\t\t * @return {function}\n\t\t */\n\t\tgetScoreFunction: function(query) {\n\t\t\treturn this.sifter.getScoreFunction(query, this.getSearchOptions());\n\t\t},\n\t\n\t\t/**\n\t\t * Returns search options for sifter (the system\n\t\t * for scoring and sorting results).\n\t\t *\n\t\t * @see https://github.com/brianreavis/sifter.js\n\t\t * @return {object}\n\t\t */\n\t\tgetSearchOptions: function() {\n\t\t\tvar settings = this.settings;\n\t\t\tvar sort = settings.sortField;\n\t\t\tif (typeof sort === 'string') {\n\t\t\t\tsort = [{field: sort}];\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\tfields      : settings.searchField,\n\t\t\t\tconjunction : settings.searchConjunction,\n\t\t\t\tsort        : sort,\n\t\t\t\tnesting     : settings.nesting\n\t\t\t};\n\t\t},\n\t\n\t\t/**\n\t\t * Searches through available options and returns\n\t\t * a sorted array of matches.\n\t\t *\n\t\t * Returns an object containing:\n\t\t *\n\t\t *   - query {string}\n\t\t *   - tokens {array}\n\t\t *   - total {int}\n\t\t *   - items {array}\n\t\t *\n\t\t * @param {string} query\n\t\t * @returns {object}\n\t\t */\n\t\tsearch: function(query) {\n\t\t\tvar i, value, score, result, calculateScore;\n\t\t\tvar self     = this;\n\t\t\tvar settings = self.settings;\n\t\t\tvar options  = this.getSearchOptions();\n\t\n\t\t\t// validate user-provided result scoring function\n\t\t\tif (settings.score) {\n\t\t\t\tcalculateScore = self.settings.score.apply(this, [query]);\n\t\t\t\tif (typeof calculateScore !== 'function') {\n\t\t\t\t\tthrow new Error('Selectize \"score\" setting must be a function that returns a function');\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// perform search\n\t\t\tif (query !== self.lastQuery) {\n\t\t\t\tself.lastQuery = query;\n\t\t\t\tresult = self.sifter.search(query, $.extend(options, {score: calculateScore}));\n\t\t\t\tself.currentResults = result;\n\t\t\t} else {\n\t\t\t\tresult = $.extend(true, {}, self.currentResults);\n\t\t\t}\n\t\n\t\t\t// filter out selected items\n\t\t\tif (settings.hideSelected) {\n\t\t\t\tfor (i = result.items.length - 1; i >= 0; i--) {\n\t\t\t\t\tif (self.items.indexOf(hash_key(result.items[i].id)) !== -1) {\n\t\t\t\t\t\tresult.items.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn result;\n\t\t},\n\t\n\t\t/**\n\t\t * Refreshes the list of available options shown\n\t\t * in the autocomplete dropdown menu.\n\t\t *\n\t\t * @param {boolean} triggerDropdown\n\t\t */\n\t\trefreshOptions: function(triggerDropdown) {\n\t\t\tvar i, j, k, n, groups, groups_order, option, option_html, optgroup, optgroups, html, html_children, has_create_option;\n\t\t\tvar $active, $active_before, $create;\n\t\n\t\t\tif (typeof triggerDropdown === 'undefined') {\n\t\t\t\ttriggerDropdown = true;\n\t\t\t}\n\t\n\t\t\tvar self              = this;\n\t\t\tvar query             = $.trim(self.$control_input.val());\n\t\t\tvar results           = self.search(query);\n\t\t\tvar $dropdown_content = self.$dropdown_content;\n\t\t\tvar active_before     = self.$activeOption && hash_key(self.$activeOption.attr('data-value'));\n\t\n\t\t\t// build markup\n\t\t\tn = results.items.length;\n\t\t\tif (typeof self.settings.maxOptions === 'number') {\n\t\t\t\tn = Math.min(n, self.settings.maxOptions);\n\t\t\t}\n\t\n\t\t\t// render and group available options individually\n\t\t\tgroups = {};\n\t\t\tgroups_order = [];\n\t\n\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\toption      = self.options[results.items[i].id];\n\t\t\t\toption_html = self.render('option', option);\n\t\t\t\toptgroup    = option[self.settings.optgroupField] || '';\n\t\t\t\toptgroups   = $.isArray(optgroup) ? optgroup : [optgroup];\n\t\n\t\t\t\tfor (j = 0, k = optgroups && optgroups.length; j < k; j++) {\n\t\t\t\t\toptgroup = optgroups[j];\n\t\t\t\t\tif (!self.optgroups.hasOwnProperty(optgroup)) {\n\t\t\t\t\t\toptgroup = '';\n\t\t\t\t\t}\n\t\t\t\t\tif (!groups.hasOwnProperty(optgroup)) {\n\t\t\t\t\t\tgroups[optgroup] = document.createDocumentFragment();\n\t\t\t\t\t\tgroups_order.push(optgroup);\n\t\t\t\t\t}\n\t\t\t\t\tgroups[optgroup].appendChild(option_html);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// sort optgroups\n\t\t\tif (this.settings.lockOptgroupOrder) {\n\t\t\t\tgroups_order.sort(function(a, b) {\n\t\t\t\t\tvar a_order = self.optgroups[a].$order || 0;\n\t\t\t\t\tvar b_order = self.optgroups[b].$order || 0;\n\t\t\t\t\treturn a_order - b_order;\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\t// render optgroup headers & join groups\n\t\t\thtml = document.createDocumentFragment();\n\t\t\tfor (i = 0, n = groups_order.length; i < n; i++) {\n\t\t\t\toptgroup = groups_order[i];\n\t\t\t\tif (self.optgroups.hasOwnProperty(optgroup) && groups[optgroup].childNodes.length) {\n\t\t\t\t\t// render the optgroup header and options within it,\n\t\t\t\t\t// then pass it to the wrapper template\n\t\t\t\t\thtml_children = document.createDocumentFragment();\n\t\t\t\t\thtml_children.appendChild(self.render('optgroup_header', self.optgroups[optgroup]));\n\t\t\t\t\thtml_children.appendChild(groups[optgroup]);\n\t\n\t\t\t\t\thtml.appendChild(self.render('optgroup', $.extend({}, self.optgroups[optgroup], {\n\t\t\t\t\t\thtml: domToString(html_children),\n\t\t\t\t\t\tdom:  html_children\n\t\t\t\t\t})));\n\t\t\t\t} else {\n\t\t\t\t\thtml.appendChild(groups[optgroup]);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t$dropdown_content.html(html);\n\t\n\t\t\t// highlight matching terms inline\n\t\t\tif (self.settings.highlight) {\n\t\t\t\t$dropdown_content.removeHighlight();\n\t\t\t\tif (results.query.length && results.tokens.length) {\n\t\t\t\t\tfor (i = 0, n = results.tokens.length; i < n; i++) {\n\t\t\t\t\t\thighlight($dropdown_content, results.tokens[i].regex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// add \"selected\" class to selected options\n\t\t\tif (!self.settings.hideSelected) {\n\t\t\t\tfor (i = 0, n = self.items.length; i < n; i++) {\n\t\t\t\t\tself.getOption(self.items[i]).addClass('selected');\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// add create option\n\t\t\thas_create_option = self.canCreate(query);\n\t\t\tif (has_create_option) {\n\t\t\t\t$dropdown_content.prepend(self.render('option_create', {input: query}));\n\t\t\t\t$create = $($dropdown_content[0].childNodes[0]);\n\t\t\t}\n\t\n\t\t\t// activate\n\t\t\tself.hasOptions = results.items.length > 0 || has_create_option;\n\t\t\tif (self.hasOptions) {\n\t\t\t\tif (results.items.length > 0) {\n\t\t\t\t\t$active_before = active_before && self.getOption(active_before);\n\t\t\t\t\tif ($active_before && $active_before.length) {\n\t\t\t\t\t\t$active = $active_before;\n\t\t\t\t\t} else if (self.settings.mode === 'single' && self.items.length) {\n\t\t\t\t\t\t$active = self.getOption(self.items[0]);\n\t\t\t\t\t}\n\t\t\t\t\tif (!$active || !$active.length) {\n\t\t\t\t\t\tif ($create && !self.settings.addPrecedence) {\n\t\t\t\t\t\t\t$active = self.getAdjacentOption($create, 1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$active = $dropdown_content.find('[data-selectable]:first');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $create;\n\t\t\t\t}\n\t\t\t\tself.setActiveOption($active);\n\t\t\t\tif (triggerDropdown && !self.isOpen) { self.open(); }\n\t\t\t} else {\n\t\t\t\tself.setActiveOption(null);\n\t\t\t\tif (triggerDropdown && self.isOpen) { self.close(); }\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Adds an available option. If it already exists,\n\t\t * nothing will happen. Note: this does not refresh\n\t\t * the options list dropdown (use `refreshOptions`\n\t\t * for that).\n\t\t *\n\t\t * Usage:\n\t\t *\n\t\t *   this.addOption(data)\n\t\t *\n\t\t * @param {object|array} data\n\t\t */\n\t\taddOption: function(data) {\n\t\t\tvar i, n, value, self = this;\n\t\n\t\t\tif ($.isArray(data)) {\n\t\t\t\tfor (i = 0, n = data.length; i < n; i++) {\n\t\t\t\t\tself.addOption(data[i]);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (value = self.registerOption(data)) {\n\t\t\t\tself.userOptions[value] = true;\n\t\t\t\tself.lastQuery = null;\n\t\t\t\tself.trigger('option_add', value, data);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Registers an option to the pool of options.\n\t\t *\n\t\t * @param {object} data\n\t\t * @return {boolean|string}\n\t\t */\n\t\tregisterOption: function(data) {\n\t\t\tvar key = hash_key(data[this.settings.valueField]);\n\t\t\tif (typeof key === 'undefined' || key === null || this.options.hasOwnProperty(key)) return false;\n\t\t\tdata.$order = data.$order || ++this.order;\n\t\t\tthis.options[key] = data;\n\t\t\treturn key;\n\t\t},\n\t\n\t\t/**\n\t\t * Registers an option group to the pool of option groups.\n\t\t *\n\t\t * @param {object} data\n\t\t * @return {boolean|string}\n\t\t */\n\t\tregisterOptionGroup: function(data) {\n\t\t\tvar key = hash_key(data[this.settings.optgroupValueField]);\n\t\t\tif (!key) return false;\n\t\n\t\t\tdata.$order = data.$order || ++this.order;\n\t\t\tthis.optgroups[key] = data;\n\t\t\treturn key;\n\t\t},\n\t\n\t\t/**\n\t\t * Registers a new optgroup for options\n\t\t * to be bucketed into.\n\t\t *\n\t\t * @param {string} id\n\t\t * @param {object} data\n\t\t */\n\t\taddOptionGroup: function(id, data) {\n\t\t\tdata[this.settings.optgroupValueField] = id;\n\t\t\tif (id = this.registerOptionGroup(data)) {\n\t\t\t\tthis.trigger('optgroup_add', id, data);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Removes an existing option group.\n\t\t *\n\t\t * @param {string} id\n\t\t */\n\t\tremoveOptionGroup: function(id) {\n\t\t\tif (this.optgroups.hasOwnProperty(id)) {\n\t\t\t\tdelete this.optgroups[id];\n\t\t\t\tthis.renderCache = {};\n\t\t\t\tthis.trigger('optgroup_remove', id);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Clears all existing option groups.\n\t\t */\n\t\tclearOptionGroups: function() {\n\t\t\tthis.optgroups = {};\n\t\t\tthis.renderCache = {};\n\t\t\tthis.trigger('optgroup_clear');\n\t\t},\n\t\n\t\t/**\n\t\t * Updates an option available for selection. If\n\t\t * it is visible in the selected items or options\n\t\t * dropdown, it will be re-rendered automatically.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {object} data\n\t\t */\n\t\tupdateOption: function(value, data) {\n\t\t\tvar self = this;\n\t\t\tvar $item, $item_new;\n\t\t\tvar value_new, index_item, cache_items, cache_options, order_old;\n\t\n\t\t\tvalue     = hash_key(value);\n\t\t\tvalue_new = hash_key(data[self.settings.valueField]);\n\t\n\t\t\t// sanity checks\n\t\t\tif (value === null) return;\n\t\t\tif (!self.options.hasOwnProperty(value)) return;\n\t\t\tif (typeof value_new !== 'string') throw new Error('Value must be set in option data');\n\t\n\t\t\torder_old = self.options[value].$order;\n\t\n\t\t\t// update references\n\t\t\tif (value_new !== value) {\n\t\t\t\tdelete self.options[value];\n\t\t\t\tindex_item = self.items.indexOf(value);\n\t\t\t\tif (index_item !== -1) {\n\t\t\t\t\tself.items.splice(index_item, 1, value_new);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata.$order = data.$order || order_old;\n\t\t\tself.options[value_new] = data;\n\t\n\t\t\t// invalidate render cache\n\t\t\tcache_items = self.renderCache['item'];\n\t\t\tcache_options = self.renderCache['option'];\n\t\n\t\t\tif (cache_items) {\n\t\t\t\tdelete cache_items[value];\n\t\t\t\tdelete cache_items[value_new];\n\t\t\t}\n\t\t\tif (cache_options) {\n\t\t\t\tdelete cache_options[value];\n\t\t\t\tdelete cache_options[value_new];\n\t\t\t}\n\t\n\t\t\t// update the item if it's selected\n\t\t\tif (self.items.indexOf(value_new) !== -1) {\n\t\t\t\t$item = self.getItem(value);\n\t\t\t\t$item_new = $(self.render('item', data));\n\t\t\t\tif ($item.hasClass('active')) $item_new.addClass('active');\n\t\t\t\t$item.replaceWith($item_new);\n\t\t\t}\n\t\n\t\t\t// invalidate last query because we might have updated the sortField\n\t\t\tself.lastQuery = null;\n\t\n\t\t\t// update dropdown contents\n\t\t\tif (self.isOpen) {\n\t\t\t\tself.refreshOptions(false);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Removes a single option.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} silent\n\t\t */\n\t\tremoveOption: function(value, silent) {\n\t\t\tvar self = this;\n\t\t\tvalue = hash_key(value);\n\t\n\t\t\tvar cache_items = self.renderCache['item'];\n\t\t\tvar cache_options = self.renderCache['option'];\n\t\t\tif (cache_items) delete cache_items[value];\n\t\t\tif (cache_options) delete cache_options[value];\n\t\n\t\t\tdelete self.userOptions[value];\n\t\t\tdelete self.options[value];\n\t\t\tself.lastQuery = null;\n\t\t\tself.trigger('option_remove', value);\n\t\t\tself.removeItem(value, silent);\n\t\t},\n\t\n\t\t/**\n\t\t * Clears all options.\n\t\t */\n\t\tclearOptions: function() {\n\t\t\tvar self = this;\n\t\n\t\t\tself.loadedSearches = {};\n\t\t\tself.userOptions = {};\n\t\t\tself.renderCache = {};\n\t\t\tvar options = self.options;\n\t\t\t$.each(self.options, function(key, value) {\n\t\t\t\tif(self.items.indexOf(key) == -1) {\n\t\t\t\t\tdelete options[key];\n\t\t\t\t}\n\t\t\t});\n\t\t\tself.options = self.sifter.items = options;\n\t\t\tself.lastQuery = null;\n\t\t\tself.trigger('option_clear');\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the jQuery element of the option\n\t\t * matching the given value.\n\t\t *\n\t\t * @param {string} value\n\t\t * @returns {object}\n\t\t */\n\t\tgetOption: function(value) {\n\t\t\treturn this.getElementWithValue(value, this.$dropdown_content.find('[data-selectable]'));\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the jQuery element of the next or\n\t\t * previous selectable option.\n\t\t *\n\t\t * @param {object} $option\n\t\t * @param {int} direction  can be 1 for next or -1 for previous\n\t\t * @return {object}\n\t\t */\n\t\tgetAdjacentOption: function($option, direction) {\n\t\t\tvar $options = this.$dropdown.find('[data-selectable]');\n\t\t\tvar index    = $options.index($option) + direction;\n\t\n\t\t\treturn index >= 0 && index < $options.length ? $options.eq(index) : $();\n\t\t},\n\t\n\t\t/**\n\t\t * Finds the first element with a \"data-value\" attribute\n\t\t * that matches the given value.\n\t\t *\n\t\t * @param {mixed} value\n\t\t * @param {object} $els\n\t\t * @return {object}\n\t\t */\n\t\tgetElementWithValue: function(value, $els) {\n\t\t\tvalue = hash_key(value);\n\t\n\t\t\tif (typeof value !== 'undefined' && value !== null) {\n\t\t\t\tfor (var i = 0, n = $els.length; i < n; i++) {\n\t\t\t\t\tif ($els[i].getAttribute('data-value') === value) {\n\t\t\t\t\t\treturn $($els[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn $();\n\t\t},\n\t\n\t\t/**\n\t\t * Returns the jQuery element of the item\n\t\t * matching the given value.\n\t\t *\n\t\t * @param {string} value\n\t\t * @returns {object}\n\t\t */\n\t\tgetItem: function(value) {\n\t\t\treturn this.getElementWithValue(value, this.$control.children());\n\t\t},\n\t\n\t\t/**\n\t\t * \"Selects\" multiple items at once. Adds them to the list\n\t\t * at the current caret position.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} silent\n\t\t */\n\t\taddItems: function(values, silent) {\n\t\t\tthis.buffer = document.createDocumentFragment();\n\t\n\t\t\tvar childNodes = this.$control[0].childNodes;\n\t\t\tfor (var i = 0; i < childNodes.length; i++) {\n\t\t\t\tthis.buffer.appendChild(childNodes[i]);\n\t\t\t}\n\t\n\t\t\tvar items = $.isArray(values) ? values : [values];\n\t\t\tfor (var i = 0, n = items.length; i < n; i++) {\n\t\t\t\tthis.isPending = (i < n - 1);\n\t\t\t\tthis.addItem(items[i], silent);\n\t\t\t}\n\t\n\t\t\tvar control = this.$control[0];\n\t\t\tcontrol.insertBefore(this.buffer, control.firstChild);\n\t\n\t\t\tthis.buffer = null;\n\t\t},\n\t\n\t\t/**\n\t\t * \"Selects\" an item. Adds it to the list\n\t\t * at the current caret position.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} silent\n\t\t */\n\t\taddItem: function(value, silent) {\n\t\t\tvar events = silent ? [] : ['change'];\n\t\n\t\t\tdebounce_events(this, events, function() {\n\t\t\t\tvar $item, $option, $options;\n\t\t\t\tvar self = this;\n\t\t\t\tvar inputMode = self.settings.mode;\n\t\t\t\tvar i, active, value_next, wasFull;\n\t\t\t\tvalue = hash_key(value);\n\t\n\t\t\t\tif (self.items.indexOf(value) !== -1) {\n\t\t\t\t\tif (inputMode === 'single') self.close();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (!self.options.hasOwnProperty(value)) return;\n\t\t\t\tif (inputMode === 'single') self.clear(silent);\n\t\t\t\tif (inputMode === 'multi' && self.isFull()) return;\n\t\n\t\t\t\t$item = $(self.render('item', self.options[value]));\n\t\t\t\twasFull = self.isFull();\n\t\t\t\tself.items.splice(self.caretPos, 0, value);\n\t\t\t\tself.insertAtCaret($item);\n\t\t\t\tif (!self.isPending || (!wasFull && self.isFull())) {\n\t\t\t\t\tself.refreshState();\n\t\t\t\t}\n\t\n\t\t\t\tif (self.isSetup) {\n\t\t\t\t\t$options = self.$dropdown_content.find('[data-selectable]');\n\t\n\t\t\t\t\t// update menu / remove the option (if this is not one item being added as part of series)\n\t\t\t\t\tif (!self.isPending) {\n\t\t\t\t\t\t$option = self.getOption(value);\n\t\t\t\t\t\tvalue_next = self.getAdjacentOption($option, 1).attr('data-value');\n\t\t\t\t\t\tself.refreshOptions(self.isFocused && inputMode !== 'single');\n\t\t\t\t\t\tif (value_next) {\n\t\t\t\t\t\t\tself.setActiveOption(self.getOption(value_next));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// hide the menu if the maximum number of items have been selected or no options are left\n\t\t\t\t\tif (!$options.length || self.isFull()) {\n\t\t\t\t\t\tself.close();\n\t\t\t\t\t} else if (!self.isPending) {\n\t\t\t\t\t\tself.positionDropdown();\n\t\t\t\t\t}\n\t\n\t\t\t\t\tself.updatePlaceholder();\n\t\t\t\t\tself.trigger('item_add', value, $item);\n\t\n\t\t\t\t\tif (!self.isPending) {\n\t\t\t\t\t\tself.updateOriginalInput({silent: silent});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Removes the selected item matching\n\t\t * the provided value.\n\t\t *\n\t\t * @param {string} value\n\t\t */\n\t\tremoveItem: function(value, silent) {\n\t\t\tvar self = this;\n\t\t\tvar $item, i, idx;\n\t\n\t\t\t$item = (value instanceof $) ? value : self.getItem(value);\n\t\t\tvalue = hash_key($item.attr('data-value'));\n\t\t\ti = self.items.indexOf(value);\n\t\n\t\t\tif (i !== -1) {\n\t\t\t\t$item.remove();\n\t\t\t\tif ($item.hasClass('active')) {\n\t\t\t\t\tidx = self.$activeItems.indexOf($item[0]);\n\t\t\t\t\tself.$activeItems.splice(idx, 1);\n\t\t\t\t}\n\t\n\t\t\t\tself.items.splice(i, 1);\n\t\t\t\tself.lastQuery = null;\n\t\t\t\tif (!self.settings.persist && self.userOptions.hasOwnProperty(value)) {\n\t\t\t\t\tself.removeOption(value, silent);\n\t\t\t\t}\n\t\n\t\t\t\tif (i < self.caretPos) {\n\t\t\t\t\tself.setCaret(self.caretPos - 1);\n\t\t\t\t}\n\t\n\t\t\t\tself.refreshState();\n\t\t\t\tself.updatePlaceholder();\n\t\t\t\tself.updateOriginalInput({silent: silent});\n\t\t\t\tself.positionDropdown();\n\t\t\t\tself.trigger('item_remove', value, $item);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Invokes the `create` method provided in the\n\t\t * selectize options that should provide the data\n\t\t * for the new item, given the user input.\n\t\t *\n\t\t * Once this completes, it will be added\n\t\t * to the item list.\n\t\t *\n\t\t * @param {string} value\n\t\t * @param {boolean} [triggerDropdown]\n\t\t * @param {function} [callback]\n\t\t * @return {boolean}\n\t\t */\n\t\tcreateItem: function(input, triggerDropdown) {\n\t\t\tvar self  = this;\n\t\t\tvar caret = self.caretPos;\n\t\t\tinput = input || $.trim(self.$control_input.val() || '');\n\t\n\t\t\tvar callback = arguments[arguments.length - 1];\n\t\t\tif (typeof callback !== 'function') callback = function() {};\n\t\n\t\t\tif (typeof triggerDropdown !== 'boolean') {\n\t\t\t\ttriggerDropdown = true;\n\t\t\t}\n\t\n\t\t\tif (!self.canCreate(input)) {\n\t\t\t\tcallback();\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\tself.lock();\n\t\n\t\t\tvar setup = (typeof self.settings.create === 'function') ? this.settings.create : function(input) {\n\t\t\t\tvar data = {};\n\t\t\t\tdata[self.settings.labelField] = input;\n\t\t\t\tdata[self.settings.valueField] = input;\n\t\t\t\treturn data;\n\t\t\t};\n\t\n\t\t\tvar create = once(function(data) {\n\t\t\t\tself.unlock();\n\t\n\t\t\t\tif (!data || typeof data !== 'object') return callback();\n\t\t\t\tvar value = hash_key(data[self.settings.valueField]);\n\t\t\t\tif (typeof value !== 'string') return callback();\n\t\n\t\t\t\tself.setTextboxValue('');\n\t\t\t\tself.addOption(data);\n\t\t\t\tself.setCaret(caret);\n\t\t\t\tself.addItem(value);\n\t\t\t\tself.refreshOptions(triggerDropdown && self.settings.mode !== 'single');\n\t\t\t\tcallback(data);\n\t\t\t});\n\t\n\t\t\tvar output = setup.apply(this, [input, create]);\n\t\t\tif (typeof output !== 'undefined') {\n\t\t\t\tcreate(output);\n\t\t\t}\n\t\n\t\t\treturn true;\n\t\t},\n\t\n\t\t/**\n\t\t * Re-renders the selected item lists.\n\t\t */\n\t\trefreshItems: function() {\n\t\t\tthis.lastQuery = null;\n\t\n\t\t\tif (this.isSetup) {\n\t\t\t\tthis.addItem(this.items);\n\t\t\t}\n\t\n\t\t\tthis.refreshState();\n\t\t\tthis.updateOriginalInput();\n\t\t},\n\t\n\t\t/**\n\t\t * Updates all state-dependent attributes\n\t\t * and CSS classes.\n\t\t */\n\t\trefreshState: function() {\n\t\t\tthis.refreshValidityState();\n\t\t\tthis.refreshClasses();\n\t\t},\n\t\n\t\t/**\n\t\t * Update the `required` attribute of both input and control input.\n\t\t *\n\t\t * The `required` property needs to be activated on the control input\n\t\t * for the error to be displayed at the right place. `required` also\n\t\t * needs to be temporarily deactivated on the input since the input is\n\t\t * hidden and can't show errors.\n\t\t */\n\t\trefreshValidityState: function() {\n\t\t\tif (!this.isRequired) return false;\n\t\n\t\t\tvar invalid = !this.items.length;\n\t\n\t\t\tthis.isInvalid = invalid;\n\t\t\tthis.$control_input.prop('required', invalid);\n\t\t\tthis.$input.prop('required', !invalid);\n\t\t},\n\t\n\t\t/**\n\t\t * Updates all state-dependent CSS classes.\n\t\t */\n\t\trefreshClasses: function() {\n\t\t\tvar self     = this;\n\t\t\tvar isFull   = self.isFull();\n\t\t\tvar isLocked = self.isLocked;\n\t\n\t\t\tself.$wrapper\n\t\t\t\t.toggleClass('rtl', self.rtl);\n\t\n\t\t\tself.$control\n\t\t\t\t.toggleClass('focus', self.isFocused)\n\t\t\t\t.toggleClass('disabled', self.isDisabled)\n\t\t\t\t.toggleClass('required', self.isRequired)\n\t\t\t\t.toggleClass('invalid', self.isInvalid)\n\t\t\t\t.toggleClass('locked', isLocked)\n\t\t\t\t.toggleClass('full', isFull).toggleClass('not-full', !isFull)\n\t\t\t\t.toggleClass('input-active', self.isFocused && !self.isInputHidden)\n\t\t\t\t.toggleClass('dropdown-active', self.isOpen)\n\t\t\t\t.toggleClass('has-options', !$.isEmptyObject(self.options))\n\t\t\t\t.toggleClass('has-items', self.items.length > 0);\n\t\n\t\t\tself.$control_input.data('grow', !isFull && !isLocked);\n\t\t},\n\t\n\t\t/**\n\t\t * Determines whether or not more items can be added\n\t\t * to the control without exceeding the user-defined maximum.\n\t\t *\n\t\t * @returns {boolean}\n\t\t */\n\t\tisFull: function() {\n\t\t\treturn this.settings.maxItems !== null && this.items.length >= this.settings.maxItems;\n\t\t},\n\t\n\t\t/**\n\t\t * Refreshes the original <select> or <input>\n\t\t * element to reflect the current state.\n\t\t */\n\t\tupdateOriginalInput: function(opts) {\n\t\t\tvar i, n, options, label, self = this;\n\t\t\topts = opts || {};\n\t\n\t\t\tif (self.tagType === TAG_SELECT) {\n\t\t\t\toptions = [];\n\t\t\t\tfor (i = 0, n = self.items.length; i < n; i++) {\n\t\t\t\t\tlabel = self.options[self.items[i]][self.settings.labelField] || '';\n\t\t\t\t\toptions.push('<option value=\"' + escape_html(self.items[i]) + '\" selected=\"selected\">' + escape_html(label) + '</option>');\n\t\t\t\t}\n\t\t\t\tif (!options.length && !this.$input.attr('multiple')) {\n\t\t\t\t\toptions.push('<option value=\"\" selected=\"selected\"></option>');\n\t\t\t\t}\n\t\t\t\tself.$input.html(options.join(''));\n\t\t\t} else {\n\t\t\t\tself.$input.val(self.getValue());\n\t\t\t\tself.$input.attr('value',self.$input.val());\n\t\t\t}\n\t\n\t\t\tif (self.isSetup) {\n\t\t\t\tif (!opts.silent) {\n\t\t\t\t\tself.trigger('change', self.$input.val());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Shows/hide the input placeholder depending\n\t\t * on if there items in the list already.\n\t\t */\n\t\tupdatePlaceholder: function() {\n\t\t\tif (!this.settings.placeholder) return;\n\t\t\tvar $input = this.$control_input;\n\t\n\t\t\tif (this.items.length) {\n\t\t\t\t$input.removeAttr('placeholder');\n\t\t\t} else {\n\t\t\t\t$input.attr('placeholder', this.settings.placeholder);\n\t\t\t}\n\t\t\t$input.triggerHandler('update', {force: true});\n\t\t},\n\t\n\t\t/**\n\t\t * Shows the autocomplete dropdown containing\n\t\t * the available options.\n\t\t */\n\t\topen: function() {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.isLocked || self.isOpen || (self.settings.mode === 'multi' && self.isFull())) return;\n\t\t\tself.focus();\n\t\t\tself.isOpen = true;\n\t\t\tself.refreshState();\n\t\t\tself.$dropdown.css({visibility: 'hidden', display: 'block'});\n\t\t\tself.positionDropdown();\n\t\t\tself.$dropdown.css({visibility: 'visible'});\n\t\t\tself.trigger('dropdown_open', self.$dropdown);\n\t\t},\n\t\n\t\t/**\n\t\t * Closes the autocomplete dropdown menu.\n\t\t */\n\t\tclose: function() {\n\t\t\tvar self = this;\n\t\t\tvar trigger = self.isOpen;\n\t\n\t\t\tif (self.settings.mode === 'single' && self.items.length) {\n\t\t\t\tself.hideInput();\n\t\n\t\t\t\t// Do not trigger blur while inside a blur event,\n\t\t\t\t// this fixes some weird tabbing behavior in FF and IE.\n\t\t\t\t// See #1164\n\t\t\t\tif (!self.isBlurring) {\n\t\t\t\t\tself.$control_input.blur(); // close keyboard on iOS\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tself.isOpen = false;\n\t\t\tself.$dropdown.hide();\n\t\t\tself.setActiveOption(null);\n\t\t\tself.refreshState();\n\t\n\t\t\tif (trigger) self.trigger('dropdown_close', self.$dropdown);\n\t\t},\n\t\n\t\t/**\n\t\t * Calculates and applies the appropriate\n\t\t * position of the dropdown.\n\t\t */\n\t\tpositionDropdown: function() {\n\t\t\tvar $control = this.$control;\n\t\t\tvar offset = this.settings.dropdownParent === 'body' ? $control.offset() : $control.position();\n\t\t\toffset.top += $control.outerHeight(true);\n\t\n\t\t\tthis.$dropdown.css({\n\t\t\t\twidth : $control[0].getBoundingClientRect().width,\n\t\t\t\ttop   : offset.top,\n\t\t\t\tleft  : offset.left\n\t\t\t});\n\t\t},\n\t\n\t\t/**\n\t\t * Resets / clears all selected items\n\t\t * from the control.\n\t\t *\n\t\t * @param {boolean} silent\n\t\t */\n\t\tclear: function(silent) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (!self.items.length) return;\n\t\t\tself.$control.children(':not(input)').remove();\n\t\t\tself.items = [];\n\t\t\tself.lastQuery = null;\n\t\t\tself.setCaret(0);\n\t\t\tself.setActiveItem(null);\n\t\t\tself.updatePlaceholder();\n\t\t\tself.updateOriginalInput({silent: silent});\n\t\t\tself.refreshState();\n\t\t\tself.showInput();\n\t\t\tself.trigger('clear');\n\t\t},\n\t\n\t\t/**\n\t\t * A helper method for inserting an element\n\t\t * at the current caret position.\n\t\t *\n\t\t * @param {object} $el\n\t\t */\n\t\tinsertAtCaret: function($el) {\n\t\t\tvar caret = Math.min(this.caretPos, this.items.length);\n\t\t\tvar el = $el[0];\n\t\t\tvar target = this.buffer || this.$control[0];\n\t\n\t\t\tif (caret === 0) {\n\t\t\t\ttarget.insertBefore(el, target.firstChild);\n\t\t\t} else {\n\t\t\t\ttarget.insertBefore(el, target.childNodes[caret]);\n\t\t\t}\n\t\n\t\t\tthis.setCaret(caret + 1);\n\t\t},\n\t\n\t\t/**\n\t\t * Removes the current selected item(s).\n\t\t *\n\t\t * @param {object} e (optional)\n\t\t * @returns {boolean}\n\t\t */\n\t\tdeleteSelection: function(e) {\n\t\t\tvar i, n, direction, selection, values, caret, option_select, $option_select, $tail;\n\t\t\tvar self = this;\n\t\n\t\t\tdirection = (e && e.keyCode === KEY_BACKSPACE) ? -1 : 1;\n\t\t\tselection = getSelection(self.$control_input[0]);\n\t\n\t\t\tif (self.$activeOption && !self.settings.hideSelected) {\n\t\t\t\toption_select = self.getAdjacentOption(self.$activeOption, -1).attr('data-value');\n\t\t\t}\n\t\n\t\t\t// determine items that will be removed\n\t\t\tvalues = [];\n\t\n\t\t\tif (self.$activeItems.length) {\n\t\t\t\t$tail = self.$control.children('.active:' + (direction > 0 ? 'last' : 'first'));\n\t\t\t\tcaret = self.$control.children(':not(input)').index($tail);\n\t\t\t\tif (direction > 0) { caret++; }\n\t\n\t\t\t\tfor (i = 0, n = self.$activeItems.length; i < n; i++) {\n\t\t\t\t\tvalues.push($(self.$activeItems[i]).attr('data-value'));\n\t\t\t\t}\n\t\t\t\tif (e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t} else if ((self.isFocused || self.settings.mode === 'single') && self.items.length) {\n\t\t\t\tif (direction < 0 && selection.start === 0 && selection.length === 0) {\n\t\t\t\t\tvalues.push(self.items[self.caretPos - 1]);\n\t\t\t\t} else if (direction > 0 && selection.start === self.$control_input.val().length) {\n\t\t\t\t\tvalues.push(self.items[self.caretPos]);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// allow the callback to abort\n\t\t\tif (!values.length || (typeof self.settings.onDelete === 'function' && self.settings.onDelete.apply(self, [values]) === false)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// perform removal\n\t\t\tif (typeof caret !== 'undefined') {\n\t\t\t\tself.setCaret(caret);\n\t\t\t}\n\t\t\twhile (values.length) {\n\t\t\t\tself.removeItem(values.pop());\n\t\t\t}\n\t\n\t\t\tself.showInput();\n\t\t\tself.positionDropdown();\n\t\t\tself.refreshOptions(true);\n\t\n\t\t\t// select previous option\n\t\t\tif (option_select) {\n\t\t\t\t$option_select = self.getOption(option_select);\n\t\t\t\tif ($option_select.length) {\n\t\t\t\t\tself.setActiveOption($option_select);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn true;\n\t\t},\n\t\n\t\t/**\n\t\t * Selects the previous / next item (depending\n\t\t * on the `direction` argument).\n\t\t *\n\t\t * > 0 - right\n\t\t * < 0 - left\n\t\t *\n\t\t * @param {int} direction\n\t\t * @param {object} e (optional)\n\t\t */\n\t\tadvanceSelection: function(direction, e) {\n\t\t\tvar tail, selection, idx, valueLength, cursorAtEdge, $tail;\n\t\t\tvar self = this;\n\t\n\t\t\tif (direction === 0) return;\n\t\t\tif (self.rtl) direction *= -1;\n\t\n\t\t\ttail = direction > 0 ? 'last' : 'first';\n\t\t\tselection = getSelection(self.$control_input[0]);\n\t\n\t\t\tif (self.isFocused && !self.isInputHidden) {\n\t\t\t\tvalueLength = self.$control_input.val().length;\n\t\t\t\tcursorAtEdge = direction < 0\n\t\t\t\t\t? selection.start === 0 && selection.length === 0\n\t\t\t\t\t: selection.start === valueLength;\n\t\n\t\t\t\tif (cursorAtEdge && !valueLength) {\n\t\t\t\t\tself.advanceCaret(direction, e);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$tail = self.$control.children('.active:' + tail);\n\t\t\t\tif ($tail.length) {\n\t\t\t\t\tidx = self.$control.children(':not(input)').index($tail);\n\t\t\t\t\tself.setActiveItem(null);\n\t\t\t\t\tself.setCaret(direction > 0 ? idx + 1 : idx);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Moves the caret left / right.\n\t\t *\n\t\t * @param {int} direction\n\t\t * @param {object} e (optional)\n\t\t */\n\t\tadvanceCaret: function(direction, e) {\n\t\t\tvar self = this, fn, $adj;\n\t\n\t\t\tif (direction === 0) return;\n\t\n\t\t\tfn = direction > 0 ? 'next' : 'prev';\n\t\t\tif (self.isShiftDown) {\n\t\t\t\t$adj = self.$control_input[fn]();\n\t\t\t\tif ($adj.length) {\n\t\t\t\t\tself.hideInput();\n\t\t\t\t\tself.setActiveItem($adj);\n\t\t\t\t\te && e.preventDefault();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tself.setCaret(self.caretPos + direction);\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Moves the caret to the specified index.\n\t\t *\n\t\t * @param {int} i\n\t\t */\n\t\tsetCaret: function(i) {\n\t\t\tvar self = this;\n\t\n\t\t\tif (self.settings.mode === 'single') {\n\t\t\t\ti = self.items.length;\n\t\t\t} else {\n\t\t\t\ti = Math.max(0, Math.min(self.items.length, i));\n\t\t\t}\n\t\n\t\t\tif(!self.isPending) {\n\t\t\t\t// the input must be moved by leaving it in place and moving the\n\t\t\t\t// siblings, due to the fact that focus cannot be restored once lost\n\t\t\t\t// on mobile webkit devices\n\t\t\t\tvar j, n, fn, $children, $child;\n\t\t\t\t$children = self.$control.children(':not(input)');\n\t\t\t\tfor (j = 0, n = $children.length; j < n; j++) {\n\t\t\t\t\t$child = $($children[j]).detach();\n\t\t\t\t\tif (j <  i) {\n\t\t\t\t\t\tself.$control_input.before($child);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.$control.append($child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tself.caretPos = i;\n\t\t},\n\t\n\t\t/**\n\t\t * Disables user input on the control. Used while\n\t\t * items are being asynchronously created.\n\t\t */\n\t\tlock: function() {\n\t\t\tthis.close();\n\t\t\tthis.isLocked = true;\n\t\t\tthis.refreshState();\n\t\t},\n\t\n\t\t/**\n\t\t * Re-enables user input on the control.\n\t\t */\n\t\tunlock: function() {\n\t\t\tthis.isLocked = false;\n\t\t\tthis.refreshState();\n\t\t},\n\t\n\t\t/**\n\t\t * Disables user input on the control completely.\n\t\t * While disabled, it cannot receive focus.\n\t\t */\n\t\tdisable: function() {\n\t\t\tvar self = this;\n\t\t\tself.$input.prop('disabled', true);\n\t\t\tself.$control_input.prop('disabled', true).prop('tabindex', -1);\n\t\t\tself.isDisabled = true;\n\t\t\tself.lock();\n\t\t},\n\t\n\t\t/**\n\t\t * Enables the control so that it can respond\n\t\t * to focus and user input.\n\t\t */\n\t\tenable: function() {\n\t\t\tvar self = this;\n\t\t\tself.$input.prop('disabled', false);\n\t\t\tself.$control_input.prop('disabled', false).prop('tabindex', self.tabIndex);\n\t\t\tself.isDisabled = false;\n\t\t\tself.unlock();\n\t\t},\n\t\n\t\t/**\n\t\t * Completely destroys the control and\n\t\t * unbinds all event listeners so that it can\n\t\t * be garbage collected.\n\t\t */\n\t\tdestroy: function() {\n\t\t\tvar self = this;\n\t\t\tvar eventNS = self.eventNS;\n\t\t\tvar revertSettings = self.revertSettings;\n\t\n\t\t\tself.trigger('destroy');\n\t\t\tself.off();\n\t\t\tself.$wrapper.remove();\n\t\t\tself.$dropdown.remove();\n\t\n\t\t\tself.$input\n\t\t\t\t.html('')\n\t\t\t\t.append(revertSettings.$children)\n\t\t\t\t.removeAttr('tabindex')\n\t\t\t\t.removeClass('selectized')\n\t\t\t\t.attr({tabindex: revertSettings.tabindex})\n\t\t\t\t.show();\n\t\n\t\t\tself.$control_input.removeData('grow');\n\t\t\tself.$input.removeData('selectize');\n\t\n\t\t\tif (--Selectize.count == 0 && Selectize.$testInput) {\n\t\t\t\tSelectize.$testInput.remove();\n\t\t\t\tSelectize.$testInput = undefined;\n\t\t\t}\n\t\n\t\t\t$(window).off(eventNS);\n\t\t\t$(document).off(eventNS);\n\t\t\t$(document.body).off(eventNS);\n\t\n\t\t\tdelete self.$input[0].selectize;\n\t\t},\n\t\n\t\t/**\n\t\t * A helper method for rendering \"item\" and\n\t\t * \"option\" templates, given the data.\n\t\t *\n\t\t * @param {string} templateName\n\t\t * @param {object} data\n\t\t * @returns {string}\n\t\t */\n\t\trender: function(templateName, data) {\n\t\t\tvar value, id, label;\n\t\t\tvar html = '';\n\t\t\tvar cache = false;\n\t\t\tvar self = this;\n\t\t\tvar regex_tag = /^[\\t \\r\\n]*<([a-z][a-z0-9\\-_]*(?:\\:[a-z][a-z0-9\\-_]*)?)/i;\n\t\n\t\t\tif (templateName === 'option' || templateName === 'item') {\n\t\t\t\tvalue = hash_key(data[self.settings.valueField]);\n\t\t\t\tcache = !!value;\n\t\t\t}\n\t\n\t\t\t// pull markup from cache if it exists\n\t\t\tif (cache) {\n\t\t\t\tif (!isset(self.renderCache[templateName])) {\n\t\t\t\t\tself.renderCache[templateName] = {};\n\t\t\t\t}\n\t\t\t\tif (self.renderCache[templateName].hasOwnProperty(value)) {\n\t\t\t\t\treturn self.renderCache[templateName][value];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// render markup\n\t\t\thtml = $(self.settings.render[templateName].apply(this, [data, escape_html]));\n\t\n\t\t\t// add mandatory attributes\n\t\t\tif (templateName === 'option' || templateName === 'option_create') {\n\t\t\t\tif (!data[self.settings.disabledField]) {\n\t\t\t\t\thtml.attr('data-selectable', '');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (templateName === 'optgroup') {\n\t\t\t\tid = data[self.settings.optgroupValueField] || '';\n\t\t\t\thtml.attr('data-group', id);\n\t\t\t\tif(data[self.settings.disabledField]) {\n\t\t\t\t\thtml.attr('data-disabled', '');\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (templateName === 'option' || templateName === 'item') {\n\t\t\t\thtml.attr('data-value', value || '');\n\t\t\t}\n\t\n\t\t\t// update cache\n\t\t\tif (cache) {\n\t\t\t\tself.renderCache[templateName][value] = html[0];\n\t\t\t}\n\t\n\t\t\treturn html[0];\n\t\t},\n\t\n\t\t/**\n\t\t * Clears the render cache for a template. If\n\t\t * no template is given, clears all render\n\t\t * caches.\n\t\t *\n\t\t * @param {string} templateName\n\t\t */\n\t\tclearCache: function(templateName) {\n\t\t\tvar self = this;\n\t\t\tif (typeof templateName === 'undefined') {\n\t\t\t\tself.renderCache = {};\n\t\t\t} else {\n\t\t\t\tdelete self.renderCache[templateName];\n\t\t\t}\n\t\t},\n\t\n\t\t/**\n\t\t * Determines whether or not to display the\n\t\t * create item prompt, given a user input.\n\t\t *\n\t\t * @param {string} input\n\t\t * @return {boolean}\n\t\t */\n\t\tcanCreate: function(input) {\n\t\t\tvar self = this;\n\t\t\tif (!self.settings.create) return false;\n\t\t\tvar filter = self.settings.createFilter;\n\t\t\treturn input.length\n\t\t\t\t&& (typeof filter !== 'function' || filter.apply(self, [input]))\n\t\t\t\t&& (typeof filter !== 'string' || new RegExp(filter).test(input))\n\t\t\t\t&& (!(filter instanceof RegExp) || filter.test(input));\n\t\t}\n\t\n\t});\n\t\n\t\n\tSelectize.count = 0;\n\tSelectize.defaults = {\n\t\toptions: [],\n\t\toptgroups: [],\n\t\n\t\tplugins: [],\n\t\tdelimiter: ',',\n\t\tsplitOn: null, // regexp or string for splitting up values from a paste command\n\t\tpersist: true,\n\t\tdiacritics: true,\n\t\tcreate: false,\n\t\tcreateOnBlur: false,\n\t\tcreateFilter: null,\n\t\thighlight: true,\n\t\topenOnFocus: true,\n\t\tmaxOptions: 1000,\n\t\tmaxItems: null,\n\t\thideSelected: null,\n\t\taddPrecedence: false,\n\t\tselectOnTab: false,\n\t\tpreload: false,\n\t\tallowEmptyOption: false,\n\t\tcloseAfterSelect: false,\n\t\n\t\tscrollDuration: 60,\n\t\tloadThrottle: 300,\n\t\tloadingClass: 'loading',\n\t\n\t\tdataAttr: 'data-data',\n\t\toptgroupField: 'optgroup',\n\t\tvalueField: 'value',\n\t\tlabelField: 'text',\n\t\tdisabledField: 'disabled',\n\t\toptgroupLabelField: 'label',\n\t\toptgroupValueField: 'value',\n\t\tlockOptgroupOrder: false,\n\t\n\t\tsortField: '$order',\n\t\tsearchField: ['text'],\n\t\tsearchConjunction: 'and',\n\t\n\t\tmode: null,\n\t\twrapperClass: 'selectize-control',\n\t\tinputClass: 'selectize-input',\n\t\tdropdownClass: 'selectize-dropdown',\n\t\tdropdownContentClass: 'selectize-dropdown-content',\n\t\n\t\tdropdownParent: null,\n\t\n\t\tcopyClassesToDropdown: true,\n\t\n\t\t/*\n\t\tload                 : null, // function(query, callback) { ... }\n\t\tscore                : null, // function(search) { ... }\n\t\tonInitialize         : null, // function() { ... }\n\t\tonChange             : null, // function(value) { ... }\n\t\tonItemAdd            : null, // function(value, $item) { ... }\n\t\tonItemRemove         : null, // function(value) { ... }\n\t\tonClear              : null, // function() { ... }\n\t\tonOptionAdd          : null, // function(value, data) { ... }\n\t\tonOptionRemove       : null, // function(value) { ... }\n\t\tonOptionClear        : null, // function() { ... }\n\t\tonOptionGroupAdd     : null, // function(id, data) { ... }\n\t\tonOptionGroupRemove  : null, // function(id) { ... }\n\t\tonOptionGroupClear   : null, // function() { ... }\n\t\tonDropdownOpen       : null, // function($dropdown) { ... }\n\t\tonDropdownClose      : null, // function($dropdown) { ... }\n\t\tonType               : null, // function(str) { ... }\n\t\tonDelete             : null, // function(values) { ... }\n\t\t*/\n\t\n\t\trender: {\n\t\t\t/*\n\t\t\titem: null,\n\t\t\toptgroup: null,\n\t\t\toptgroup_header: null,\n\t\t\toption: null,\n\t\t\toption_create: null\n\t\t\t*/\n\t\t}\n\t};\n\t\n\t\n\t$.fn.selectize = function(settings_user) {\n\t\tvar defaults             = $.fn.selectize.defaults;\n\t\tvar settings             = $.extend({}, defaults, settings_user);\n\t\tvar attr_data            = settings.dataAttr;\n\t\tvar field_label          = settings.labelField;\n\t\tvar field_value          = settings.valueField;\n\t\tvar field_disabled       = settings.disabledField;\n\t\tvar field_optgroup       = settings.optgroupField;\n\t\tvar field_optgroup_label = settings.optgroupLabelField;\n\t\tvar field_optgroup_value = settings.optgroupValueField;\n\t\n\t\t/**\n\t\t * Initializes selectize from a <input type=\"text\"> element.\n\t\t *\n\t\t * @param {object} $input\n\t\t * @param {object} settings_element\n\t\t */\n\t\tvar init_textbox = function($input, settings_element) {\n\t\t\tvar i, n, values, option;\n\t\n\t\t\tvar data_raw = $input.attr(attr_data);\n\t\n\t\t\tif (!data_raw) {\n\t\t\t\tvar value = $.trim($input.val() || '');\n\t\t\t\tif (!settings.allowEmptyOption && !value.length) return;\n\t\t\t\tvalues = value.split(settings.delimiter);\n\t\t\t\tfor (i = 0, n = values.length; i < n; i++) {\n\t\t\t\t\toption = {};\n\t\t\t\t\toption[field_label] = values[i];\n\t\t\t\t\toption[field_value] = values[i];\n\t\t\t\t\tsettings_element.options.push(option);\n\t\t\t\t}\n\t\t\t\tsettings_element.items = values;\n\t\t\t} else {\n\t\t\t\tsettings_element.options = JSON.parse(data_raw);\n\t\t\t\tfor (i = 0, n = settings_element.options.length; i < n; i++) {\n\t\t\t\t\tsettings_element.items.push(settings_element.options[i][field_value]);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t/**\n\t\t * Initializes selectize from a <select> element.\n\t\t *\n\t\t * @param {object} $input\n\t\t * @param {object} settings_element\n\t\t */\n\t\tvar init_select = function($input, settings_element) {\n\t\t\tvar i, n, tagName, $children, order = 0;\n\t\t\tvar options = settings_element.options;\n\t\t\tvar optionsMap = {};\n\t\n\t\t\tvar readData = function($el) {\n\t\t\t\tvar data = attr_data && $el.attr(attr_data);\n\t\t\t\tif (typeof data === 'string' && data.length) {\n\t\t\t\t\treturn JSON.parse(data);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\t\n\t\t\tvar addOption = function($option, group) {\n\t\t\t\t$option = $($option);\n\t\n\t\t\t\tvar value = hash_key($option.val());\n\t\t\t\tif (!value && !settings.allowEmptyOption) return;\n\t\n\t\t\t\t// if the option already exists, it's probably been\n\t\t\t\t// duplicated in another optgroup. in this case, push\n\t\t\t\t// the current group to the \"optgroup\" property on the\n\t\t\t\t// existing option so that it's rendered in both places.\n\t\t\t\tif (optionsMap.hasOwnProperty(value)) {\n\t\t\t\t\tif (group) {\n\t\t\t\t\t\tvar arr = optionsMap[value][field_optgroup];\n\t\t\t\t\t\tif (!arr) {\n\t\t\t\t\t\t\toptionsMap[value][field_optgroup] = group;\n\t\t\t\t\t\t} else if (!$.isArray(arr)) {\n\t\t\t\t\t\t\toptionsMap[value][field_optgroup] = [arr, group];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tarr.push(group);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tvar option             = readData($option) || {};\n\t\t\t\toption[field_label]    = option[field_label] || $option.text();\n\t\t\t\toption[field_value]    = option[field_value] || value;\n\t\t\t\toption[field_disabled] = option[field_disabled] || $option.prop('disabled');\n\t\t\t\toption[field_optgroup] = option[field_optgroup] || group;\n\t\n\t\t\t\toptionsMap[value] = option;\n\t\t\t\toptions.push(option);\n\t\n\t\t\t\tif ($option.is(':selected')) {\n\t\t\t\t\tsettings_element.items.push(value);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tvar addGroup = function($optgroup) {\n\t\t\t\tvar i, n, id, optgroup, $options;\n\t\n\t\t\t\t$optgroup = $($optgroup);\n\t\t\t\tid = $optgroup.attr('label');\n\t\n\t\t\t\tif (id) {\n\t\t\t\t\toptgroup = readData($optgroup) || {};\n\t\t\t\t\toptgroup[field_optgroup_label] = id;\n\t\t\t\t\toptgroup[field_optgroup_value] = id;\n\t\t\t\t\toptgroup[field_disabled] = $optgroup.prop('disabled');\n\t\t\t\t\tsettings_element.optgroups.push(optgroup);\n\t\t\t\t}\n\t\n\t\t\t\t$options = $('option', $optgroup);\n\t\t\t\tfor (i = 0, n = $options.length; i < n; i++) {\n\t\t\t\t\taddOption($options[i], id);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tsettings_element.maxItems = $input.attr('multiple') ? null : 1;\n\t\n\t\t\t$children = $input.children();\n\t\t\tfor (i = 0, n = $children.length; i < n; i++) {\n\t\t\t\ttagName = $children[i].tagName.toLowerCase();\n\t\t\t\tif (tagName === 'optgroup') {\n\t\t\t\t\taddGroup($children[i]);\n\t\t\t\t} else if (tagName === 'option') {\n\t\t\t\t\taddOption($children[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\treturn this.each(function() {\n\t\t\tif (this.selectize) return;\n\t\n\t\t\tvar instance;\n\t\t\tvar $input = $(this);\n\t\t\tvar tag_name = this.tagName.toLowerCase();\n\t\t\tvar placeholder = $input.attr('placeholder') || $input.attr('data-placeholder');\n\t\t\tif (!placeholder && !settings.allowEmptyOption) {\n\t\t\t\tplaceholder = $input.children('option[value=\"\"]').text();\n\t\t\t}\n\t\n\t\t\tvar settings_element = {\n\t\t\t\t'placeholder' : placeholder,\n\t\t\t\t'options'     : [],\n\t\t\t\t'optgroups'   : [],\n\t\t\t\t'items'       : []\n\t\t\t};\n\t\n\t\t\tif (tag_name === 'select') {\n\t\t\t\tinit_select($input, settings_element);\n\t\t\t} else {\n\t\t\t\tinit_textbox($input, settings_element);\n\t\t\t}\n\t\n\t\t\tinstance = new Selectize($input, $.extend(true, {}, defaults, settings_element, settings_user));\n\t\t});\n\t};\n\t\n\t$.fn.selectize.defaults = Selectize.defaults;\n\t$.fn.selectize.support = {\n\t\tvalidity: SUPPORTS_VALIDITY_API\n\t};\n\t\n\t\n\tSelectize.define('drag_drop', function(options) {\n\t\tif (!$.fn.sortable) throw new Error('The \"drag_drop\" plugin requires jQuery UI \"sortable\".');\n\t\tif (this.settings.mode !== 'multi') return;\n\t\tvar self = this;\n\t\n\t\tself.lock = (function() {\n\t\t\tvar original = self.lock;\n\t\t\treturn function() {\n\t\t\t\tvar sortable = self.$control.data('sortable');\n\t\t\t\tif (sortable) sortable.disable();\n\t\t\t\treturn original.apply(self, arguments);\n\t\t\t};\n\t\t})();\n\t\n\t\tself.unlock = (function() {\n\t\t\tvar original = self.unlock;\n\t\t\treturn function() {\n\t\t\t\tvar sortable = self.$control.data('sortable');\n\t\t\t\tif (sortable) sortable.enable();\n\t\t\t\treturn original.apply(self, arguments);\n\t\t\t};\n\t\t})();\n\t\n\t\tself.setup = (function() {\n\t\t\tvar original = self.setup;\n\t\t\treturn function() {\n\t\t\t\toriginal.apply(this, arguments);\n\t\n\t\t\t\tvar $control = self.$control.sortable({\n\t\t\t\t\titems: '[data-value]',\n\t\t\t\t\tforcePlaceholderSize: true,\n\t\t\t\t\tdisabled: self.isLocked,\n\t\t\t\t\tstart: function(e, ui) {\n\t\t\t\t\t\tui.placeholder.css('width', ui.helper.css('width'));\n\t\t\t\t\t\t$control.css({overflow: 'visible'});\n\t\t\t\t\t},\n\t\t\t\t\tstop: function() {\n\t\t\t\t\t\t$control.css({overflow: 'hidden'});\n\t\t\t\t\t\tvar active = self.$activeItems ? self.$activeItems.slice() : null;\n\t\t\t\t\t\tvar values = [];\n\t\t\t\t\t\t$control.children('[data-value]').each(function() {\n\t\t\t\t\t\t\tvalues.push($(this).attr('data-value'));\n\t\t\t\t\t\t});\n\t\t\t\t\t\tself.setValue(values);\n\t\t\t\t\t\tself.setActiveItem(active);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t})();\n\t\n\t});\n\t\n\tSelectize.define('dropdown_header', function(options) {\n\t\tvar self = this;\n\t\n\t\toptions = $.extend({\n\t\t\ttitle         : 'Untitled',\n\t\t\theaderClass   : 'selectize-dropdown-header',\n\t\t\ttitleRowClass : 'selectize-dropdown-header-title',\n\t\t\tlabelClass    : 'selectize-dropdown-header-label',\n\t\t\tcloseClass    : 'selectize-dropdown-header-close',\n\t\n\t\t\thtml: function(data) {\n\t\t\t\treturn (\n\t\t\t\t\t'<div class=\"' + data.headerClass + '\">' +\n\t\t\t\t\t\t'<div class=\"' + data.titleRowClass + '\">' +\n\t\t\t\t\t\t\t'<span class=\"' + data.labelClass + '\">' + data.title + '</span>' +\n\t\t\t\t\t\t\t'<a href=\"javascript:void(0)\" class=\"' + data.closeClass + '\">&times;</a>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>'\n\t\t\t\t);\n\t\t\t}\n\t\t}, options);\n\t\n\t\tself.setup = (function() {\n\t\t\tvar original = self.setup;\n\t\t\treturn function() {\n\t\t\t\toriginal.apply(self, arguments);\n\t\t\t\tself.$dropdown_header = $(options.html(options));\n\t\t\t\tself.$dropdown.prepend(self.$dropdown_header);\n\t\t\t};\n\t\t})();\n\t\n\t});\n\t\n\tSelectize.define('optgroup_columns', function(options) {\n\t\tvar self = this;\n\t\n\t\toptions = $.extend({\n\t\t\tequalizeWidth  : true,\n\t\t\tequalizeHeight : true\n\t\t}, options);\n\t\n\t\tthis.getAdjacentOption = function($option, direction) {\n\t\t\tvar $options = $option.closest('[data-group]').find('[data-selectable]');\n\t\t\tvar index    = $options.index($option) + direction;\n\t\n\t\t\treturn index >= 0 && index < $options.length ? $options.eq(index) : $();\n\t\t};\n\t\n\t\tthis.onKeyDown = (function() {\n\t\t\tvar original = self.onKeyDown;\n\t\t\treturn function(e) {\n\t\t\t\tvar index, $option, $options, $optgroup;\n\t\n\t\t\t\tif (this.isOpen && (e.keyCode === KEY_LEFT || e.keyCode === KEY_RIGHT)) {\n\t\t\t\t\tself.ignoreHover = true;\n\t\t\t\t\t$optgroup = this.$activeOption.closest('[data-group]');\n\t\t\t\t\tindex = $optgroup.find('[data-selectable]').index(this.$activeOption);\n\t\n\t\t\t\t\tif(e.keyCode === KEY_LEFT) {\n\t\t\t\t\t\t$optgroup = $optgroup.prev('[data-group]');\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$optgroup = $optgroup.next('[data-group]');\n\t\t\t\t\t}\n\t\n\t\t\t\t\t$options = $optgroup.find('[data-selectable]');\n\t\t\t\t\t$option  = $options.eq(Math.min($options.length - 1, index));\n\t\t\t\t\tif ($option.length) {\n\t\t\t\t\t\tthis.setActiveOption($option);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\treturn original.apply(this, arguments);\n\t\t\t};\n\t\t})();\n\t\n\t\tvar getScrollbarWidth = function() {\n\t\t\tvar div;\n\t\t\tvar width = getScrollbarWidth.width;\n\t\t\tvar doc = document;\n\t\n\t\t\tif (typeof width === 'undefined') {\n\t\t\t\tdiv = doc.createElement('div');\n\t\t\t\tdiv.innerHTML = '<div style=\"width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;\"><div style=\"width:1px;height:100px;\"></div></div>';\n\t\t\t\tdiv = div.firstChild;\n\t\t\t\tdoc.body.appendChild(div);\n\t\t\t\twidth = getScrollbarWidth.width = div.offsetWidth - div.clientWidth;\n\t\t\t\tdoc.body.removeChild(div);\n\t\t\t}\n\t\t\treturn width;\n\t\t};\n\t\n\t\tvar equalizeSizes = function() {\n\t\t\tvar i, n, height_max, width, width_last, width_parent, $optgroups;\n\t\n\t\t\t$optgroups = $('[data-group]', self.$dropdown_content);\n\t\t\tn = $optgroups.length;\n\t\t\tif (!n || !self.$dropdown_content.width()) return;\n\t\n\t\t\tif (options.equalizeHeight) {\n\t\t\t\theight_max = 0;\n\t\t\t\tfor (i = 0; i < n; i++) {\n\t\t\t\t\theight_max = Math.max(height_max, $optgroups.eq(i).height());\n\t\t\t\t}\n\t\t\t\t$optgroups.css({height: height_max});\n\t\t\t}\n\t\n\t\t\tif (options.equalizeWidth) {\n\t\t\t\twidth_parent = self.$dropdown_content.innerWidth() - getScrollbarWidth();\n\t\t\t\twidth = Math.round(width_parent / n);\n\t\t\t\t$optgroups.css({width: width});\n\t\t\t\tif (n > 1) {\n\t\t\t\t\twidth_last = width_parent - width * (n - 1);\n\t\t\t\t\t$optgroups.eq(n - 1).css({width: width_last});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\tif (options.equalizeHeight || options.equalizeWidth) {\n\t\t\thook.after(this, 'positionDropdown', equalizeSizes);\n\t\t\thook.after(this, 'refreshOptions', equalizeSizes);\n\t\t}\n\t\n\t\n\t});\n\t\n\tSelectize.define('remove_button', function(options) {\n\t\toptions = $.extend({\n\t\t\t\tlabel     : '&times;',\n\t\t\t\ttitle     : 'Remove',\n\t\t\t\tclassName : 'remove',\n\t\t\t\tappend    : true\n\t\t\t}, options);\n\t\n\t\t\tvar singleClose = function(thisRef, options) {\n\t\n\t\t\t\toptions.className = 'remove-single';\n\t\n\t\t\t\tvar self = thisRef;\n\t\t\t\tvar html = '<a href=\"javascript:void(0)\" class=\"' + options.className + '\" tabindex=\"-1\" title=\"' + escape_html(options.title) + '\">' + options.label + '</a>';\n\t\n\t\t\t\t/**\n\t\t\t\t * Appends an element as a child (with raw HTML).\n\t\t\t\t *\n\t\t\t\t * @param {string} html_container\n\t\t\t\t * @param {string} html_element\n\t\t\t\t * @return {string}\n\t\t\t\t */\n\t\t\t\tvar append = function(html_container, html_element) {\n\t\t\t\t\treturn $('<span>').append(html_container)\n\t\t\t\t\t\t.append(html_element);\n\t\t\t\t};\n\t\n\t\t\t\tthisRef.setup = (function() {\n\t\t\t\t\tvar original = self.setup;\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\t// override the item rendering method to add the button to each\n\t\t\t\t\t\tif (options.append) {\n\t\t\t\t\t\t\tvar id = $(self.$input.context).attr('id');\n\t\t\t\t\t\t\tvar selectizer = $('#'+id);\n\t\n\t\t\t\t\t\t\tvar render_item = self.settings.render.item;\n\t\t\t\t\t\t\tself.settings.render.item = function(data) {\n\t\t\t\t\t\t\t\treturn append(render_item.apply(thisRef, arguments), html);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\toriginal.apply(thisRef, arguments);\n\t\n\t\t\t\t\t\t// add event listener\n\t\t\t\t\t\tthisRef.$control.on('click', '.' + options.className, function(e) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tif (self.isLocked) return;\n\t\n\t\t\t\t\t\t\tself.clear();\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t};\n\t\t\t\t})();\n\t\t\t};\n\t\n\t\t\tvar multiClose = function(thisRef, options) {\n\t\n\t\t\t\tvar self = thisRef;\n\t\t\t\tvar html = '<a href=\"javascript:void(0)\" class=\"' + options.className + '\" tabindex=\"-1\" title=\"' + escape_html(options.title) + '\">' + options.label + '</a>';\n\t\n\t\t\t\t/**\n\t\t\t\t * Appends an element as a child (with raw HTML).\n\t\t\t\t *\n\t\t\t\t * @param {string} html_container\n\t\t\t\t * @param {string} html_element\n\t\t\t\t * @return {string}\n\t\t\t\t */\n\t\t\t\tvar append = function(html_container, html_element) {\n\t\t\t\t\tvar pos = html_container.search(/(<\\/[^>]+>\\s*)$/);\n\t\t\t\t\treturn html_container.substring(0, pos) + html_element + html_container.substring(pos);\n\t\t\t\t};\n\t\n\t\t\t\tthisRef.setup = (function() {\n\t\t\t\t\tvar original = self.setup;\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\t// override the item rendering method to add the button to each\n\t\t\t\t\t\tif (options.append) {\n\t\t\t\t\t\t\tvar render_item = self.settings.render.item;\n\t\t\t\t\t\t\tself.settings.render.item = function(data) {\n\t\t\t\t\t\t\t\treturn append(render_item.apply(thisRef, arguments), html);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\toriginal.apply(thisRef, arguments);\n\t\n\t\t\t\t\t\t// add event listener\n\t\t\t\t\t\tthisRef.$control.on('click', '.' + options.className, function(e) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tif (self.isLocked) return;\n\t\n\t\t\t\t\t\t\tvar $item = $(e.currentTarget).parent();\n\t\t\t\t\t\t\tself.setActiveItem($item);\n\t\t\t\t\t\t\tif (self.deleteSelection()) {\n\t\t\t\t\t\t\t\tself.setCaret(self.items.length);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t};\n\t\t\t\t})();\n\t\t\t};\n\t\n\t\t\tif (this.settings.mode === 'single') {\n\t\t\t\tsingleClose(this, options);\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tmultiClose(this, options);\n\t\t\t}\n\t});\n\t\n\t\n\tSelectize.define('restore_on_backspace', function(options) {\n\t\tvar self = this;\n\t\n\t\toptions.text = options.text || function(option) {\n\t\t\treturn option[this.settings.labelField];\n\t\t};\n\t\n\t\tthis.onKeyDown = (function() {\n\t\t\tvar original = self.onKeyDown;\n\t\t\treturn function(e) {\n\t\t\t\tvar index, option;\n\t\t\t\tif (e.keyCode === KEY_BACKSPACE && this.$control_input.val() === '' && !this.$activeItems.length) {\n\t\t\t\t\tindex = this.caretPos - 1;\n\t\t\t\t\tif (index >= 0 && index < this.items.length) {\n\t\t\t\t\t\toption = this.options[this.items[index]];\n\t\t\t\t\t\tif (this.deleteSelection(e)) {\n\t\t\t\t\t\t\tthis.setTextboxValue(options.text.apply(this, [option]));\n\t\t\t\t\t\t\tthis.refreshOptions(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn original.apply(this, arguments);\n\t\t\t};\n\t\t})();\n\t});\n\t\n\n\treturn Selectize;\n}));"],"names":["root","factory","define","amd","exports","module","Sifter","this","items","settings","diacritics","prototype","tokenize","query","trim","String","toLowerCase","length","regex","letter","tokens","words","split","i","n","escape_regex","DIACRITICS","hasOwnProperty","replace","RegExp","push","string","iterator","object","callback","is_array","Array","forEach","key","apply","getScoreFunction","search","options","scoreValue","value","token","pos","score","field_count","prepareSearch","fields","token_count","nesting","scoreObject","data","getattr","sum","conjunction","getSortFunction","field","fields_count","multiplier","multipliers","implicit_score","self","sort","sort_empty","get_field","name","result","id","unshift","direction","splice","a","b","cmp","option_fields","extend","option_sort","option_sort_empty","total","fn_score","item","filter","fn_sort","limit","slice","asciifold","k","arguments","obj","names","shift","str","isArray","$","Object","toString","call","c","d","e","f","g","h","j","l","o","p","q","r","s","t","u","v","w","x","y","z","chunk","foreignletters","lookup","substring","charAt","regexp","foreignletter","MicroPlugin","mixin","Interface","plugins","initializePlugins","queue","requested","loaded","utils","require","loadPlugin","plugin","Error","fn","vArg","Selectize","jQuery","removeHighlight","find","each","parentNode","firstChild","nodeName","parent","replaceChild","normalize","end","MicroEvent","on","event","fct","_events","off","indexOf","trigger","destObject","props","isset","hash_key","escape_html","debounce_events","types","type","event_args","getSelection","input","sel","selLen","start","selectionStart","selectionEnd","document","selection","focus","createRange","text","moveStart","measureString","$parent","$testInput","css","position","top","left","width","padding","whiteSpace","appendTo","$from","$to","properties","styles","transferStyles","autoGrow","$input","update","keyCode","character","window","metaKey","altKey","force","val","printable","shiftKey","fromCharCode","toUpperCase","placeholder","attr","currentWidth","triggerHandler","IS_MAC","test","navigator","userAgent","KEY_CMD","KEY_CTRL","SUPPORTS_VALIDITY_API","createElement","validity","hook","before","method","original","after","selectize","delay","timeout","computedStyle","getComputedStyle","dir","getPropertyValue","currentStyle","parents","order","tabIndex","tagType","tagName","rtl","eventNS","count","highlightedValue","isBlurring","isOpen","isDisabled","isRequired","is","isInvalid","isLocked","isFocused","isInputHidden","isSetup","isShiftDown","isCmdDown","isCtrlDown","ignoreFocus","ignoreBlur","ignoreHover","hasOptions","currentResults","lastValue","caretPos","loading","loadedSearches","$activeOption","$activeItems","optgroups","userOptions","renderCache","onSearchChange","loadThrottle","args","clearTimeout","setTimeout","sifter","registerOption","registerOptionGroup","mode","maxItems","hideSelected","setupCallbacks","setupTemplates","setup","message","console","error","component","explanation","group","groupEnd","logError","delimiterEscaped","$window","$document","inputMode","classes","$wrapper","addClass","wrapperClass","$control","inputClass","$control_input","$dropdown_parent","dropdownParent","$dropdown","dropdownClass","hide","$dropdown_content","dropdownContentClass","inputId","copyClassesToDropdown","style","classes_plugins","join","splitOn","delimiter","stopImmediatePropagation","onOptionHover","onOptionSelect","selector","onItemSelect","child","target","currentTarget","mousedown","onMouseDown","click","onClick","stopPropagation","keydown","onKeyDown","keyup","onKeyUp","keypress","onKeyPress","resize","positionDropdown","blur","onBlur","onFocus","paste","onPaste","has","revertSettings","$children","children","detach","tabindex","setValue","preventDefault","refreshState","updateOriginalInput","refreshItems","updatePlaceholder","disable","onChange","preload","field_label","labelField","field_optgroup","optgroupLabelField","render","optgroup","html","optgroup_header","escape","option","option_create","callbacks","initialize","change","item_add","item_remove","clear","option_add","option_remove","option_clear","optgroup_add","optgroup_remove","optgroup_clear","dropdown_open","dropdown_close","load","defaultPrevented","isDefaultPrevented","close","open","setActiveItem","isFull","pastedText","match","splitInput","createItem","which","create","$prev","selectAll","ctrlKey","$next","getAdjacentOption","setActiveOption","advanceSelection","selectOnTab","deleteSelection","refreshOptions","wasFocused","showInput","openOnFocus","dest","activeElement","deactivate","setTextboxValue","setCaret","createOnBlur","$target","hasClass","closeAfterSelect","lastQuery","addItem","getOption","loadingClass","results","Math","max","addOption","removeClass","getValue","silent","addItems","$item","idx","begin","$last","eventName","childNodes","swap","hideInput","$option","scroll","animate","height_menu","height_item","scroll_top","height","outerHeight","scrollTop","scroll_bottom","offset","stop","scrollDuration","opacity","getSearchOptions","sortField","searchField","searchConjunction","calculateScore","triggerDropdown","groups","groups_order","option_html","html_children","has_create_option","$active","$create","tmp","active_before","maxOptions","min","optgroupField","createDocumentFragment","appendChild","lockOptgroupOrder","$order","cloneNode","innerHTML","dom","highlight","$element","pattern","node","skip","nodeType","spannode","middleclone","className","middlebit","splitText","canCreate","prepend","$active_before","addPrecedence","valueField","optgroupValueField","addOptionGroup","removeOptionGroup","clearOptionGroups","updateOption","value_new","cache_items","order_old","index_item","cache_options","getItem","$item_new","replaceWith","removeOption","removeItem","clearOptions","getElementWithValue","$options","index","eq","$els","getAttribute","values","buffer","isPending","control","insertBefore","wasFull","insertAtCaret","value_next","remove","persist","caret","lock","called","unlock","output","refreshValidityState","refreshClasses","invalid","prop","toggleClass","isEmptyObject","opts","label","removeAttr","visibility","display","getBoundingClientRect","$el","el","option_select","$option_select","$tail","onDelete","pop","valueLength","tail","advanceCaret","$adj","$child","append","enable","destroy","show","removeData","undefined","body","templateName","cache","disabledField","clearCache","createFilter","defaults","allowEmptyOption","dataAttr","settings_user","init_select","settings_element","readData","attr_data","JSON","parse","optionsMap","arr","field_value","field_disabled","$optgroup","field_optgroup_label","field_optgroup_value","addGroup","tag_name","data_raw","support","sortable","forcePlaceholderSize","disabled","ui","helper","overflow","active","title","headerClass","titleRowClass","labelClass","closeClass","$dropdown_header","equalizeWidth","equalizeHeight","closest","prev","next","equalizeSizes","height_max","width_last","width_parent","$optgroups","innerWidth","getScrollbarWidth","round","div","doc","offsetWidth","clientWidth","removeChild","thisRef","render_item","context","html_container","html_element"],"mappings":"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"}